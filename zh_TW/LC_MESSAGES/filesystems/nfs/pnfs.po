# SOME DESCRIPTIVE TITLE.
# Copyright (C) The kernel development community
# This file is distributed under the same license as the The Linux Kernel package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: The Linux Kernel master\n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2025-09-29 08:26+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: zh_TW\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#: ../../../filesystems/nfs/pnfs.rst:3
msgid "Reference counting in pnfs"
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:5
msgid ""
"The are several inter-related caches.  We have layouts which can reference "
"multiple devices, each of which can reference multiple data servers. Each "
"data server can be referenced by multiple devices.  Each device can be "
"referenced by multiple layouts. To keep all of this straight, we need to "
"reference count."
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:13
msgid "struct pnfs_layout_hdr"
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:15
msgid ""
"The on-the-wire command LAYOUTGET corresponds to struct pnfs_layout_segment, "
"usually referred to by the variable name lseg. Each nfs_inode may hold a "
"pointer to a cache of these layout segments in nfsi->layout, of type struct "
"pnfs_layout_hdr."
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:20
msgid ""
"We reference the header for the inode pointing to it, across each "
"outstanding RPC call that references it (LAYOUTGET, LAYOUTRETURN, "
"LAYOUTCOMMIT), and for each lseg held within."
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:24
msgid ""
"Each header is also (when non-empty) put on a list associated with struct "
"nfs_client (cl_layouts).  Being put on this list does not bump the reference "
"count, as the layout is kept around by the lseg that keeps it in the list."
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:30
msgid "deviceid_cache"
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:32
msgid ""
"lsegs reference device ids, which are resolved per nfs_client and layout "
"driver type.  The device ids are held in a RCU cache (struct "
"nfs4_deviceid_cache).  The cache itself is referenced across each mount.  "
"The entries (struct nfs4_deviceid) themselves are held across the lifetime "
"of each lseg referencing them."
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:38
msgid ""
"RCU is used because the deviceid is basically a write once, read many data "
"structure.  The hlist size of 32 buckets needs better justification, but "
"seems reasonable given that we can have multiple deviceid's per filesystem, "
"and multiple filesystems per nfs_client."
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:43
msgid ""
"The hash code is copied from the nfsd code base.  A discussion of hashing "
"and variations of this algorithm can be found `here. <http://groups.google."
"com/group/comp.lang.c/browse_thread/thread/9522965e2b8d3809>`_"
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:48
msgid "data server cache"
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:50
msgid ""
"file driver devices refer to data servers, which are kept in a module level "
"cache.  Its reference is held over the lifetime of the deviceid pointing to "
"it."
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:55
msgid "lseg"
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:57
msgid ""
"lseg maintains an extra reference corresponding to the NFS_LSEG_VALID bit "
"which holds it in the pnfs_layout_hdr's list.  When the final lseg is "
"removed from the pnfs_layout_hdr's list, the NFS_LAYOUT_DESTROYED bit is "
"set, preventing any new lsegs from being added."
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:63
msgid "layout drivers"
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:65
msgid ""
"PNFS utilizes what is called layout drivers. The STD defines 4 basic layout "
"types: \"files\", \"objects\", \"blocks\", and \"flexfiles\". For each of "
"these types there is a layout-driver with a common function-vectors table "
"which are called by the nfs-client pnfs-core to implement the different "
"layout types."
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:71
msgid ""
"Files-layout-driver code is in: fs/nfs/filelayout/.. directory Blocks-layout-"
"driver code is in: fs/nfs/blocklayout/.. directory Flexfiles-layout-driver "
"code is in: fs/nfs/flexfilelayout/.. directory"
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:76
msgid "blocks-layout setup"
msgstr ""

#: ../../../filesystems/nfs/pnfs.rst:78
msgid "TODO: Document the setup needs of the blocks layout driver"
msgstr ""

# SOME DESCRIPTIVE TITLE.
# Copyright (C) The kernel development community
# This file is distributed under the same license as the The Linux Kernel package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: The Linux Kernel 6\n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2025-09-27 13:54+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:4
msgid "Indirect Target Selection (ITS)"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:6
msgid ""
"ITS is a vulnerability in some Intel CPUs that support Enhanced IBRS and "
"were released before Alder Lake. ITS may allow an attacker to control the "
"prediction of indirect branches and RETs located in the lower half of a "
"cacheline."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:10
msgid "ITS is assigned CVE-2024-28956 with a CVSS score of 4.7 (Medium)."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:13
msgid "Scope of Impact"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:14
msgid ""
"**eIBRS Guest/Host Isolation**: Indirect branches in KVM/kernel may still be "
"predicted with unintended target corresponding to a branch in the guest."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:17
msgid ""
"**Intra-Mode BTI**: In-kernel training such as through cBPF or other native "
"gadgets."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:20
msgid ""
"**Indirect Branch Prediction Barrier (IBPB)**: After an IBPB, indirect "
"branches may still be predicted with targets corresponding to direct "
"branches executed prior to the IBPB. This is fixed by the IPU 2025.1 "
"microcode, which should be available via distro updates. Alternatively "
"microcode can be obtained from Intel's github repository [#f1]_."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:27
msgid "Affected CPUs"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:28
msgid "Below is the list of ITS affected CPUs [#f2]_ [#f3]_:"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:31
msgid "Common name"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:31
msgid "Family_Model"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:31
msgid "eIBRS Guest/Host Isolation"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:31
msgid "Intra-mode BTI"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:34
msgid "SKYLAKE_X (step >= 6)"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:34
msgid "06_55H"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:34
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:35
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:36
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:37
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:38
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:39
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:40
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:41
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:42
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:43
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:44
msgid "Affected"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:35
msgid "ICELAKE_X"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:35
msgid "06_6AH"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:35
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:36
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:37
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:38
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:39
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:44
#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:149
msgid "Not affected"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:36
msgid "ICELAKE_D"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:36
msgid "06_6CH"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:37
msgid "ICELAKE_L"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:37
msgid "06_7EH"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:38
msgid "TIGERLAKE_L"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:38
msgid "06_8CH"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:39
msgid "TIGERLAKE"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:39
msgid "06_8DH"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:40
msgid "KABYLAKE_L (step >= 12)"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:40
msgid "06_8EH"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:41
msgid "KABYLAKE (step >= 13)"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:41
msgid "06_9EH"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:42
msgid "COMETLAKE"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:42
msgid "06_A5H"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:43
msgid "COMETLAKE_L"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:43
msgid "06_A6H"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:44
msgid "ROCKETLAKE"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:44
msgid "06_A7H"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:47
msgid "All affected CPUs enumerate Enhanced IBRS feature."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:48
msgid ""
"IBPB isolation is affected on all ITS affected CPUs, and need a microcode "
"update for mitigation."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:50
msgid ""
"None of the affected CPUs enumerate BHI_CTRL which was introduced in Golden "
"Cove (Alder Lake and Sapphire Rapids). This can help guests to determine the "
"host's affected status."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:53
msgid "Intel Atom CPUs are not affected by ITS."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:56
msgid "Mitigation"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:57
msgid ""
"As only the indirect branches and RETs that have their last byte of "
"instruction in the lower half of the cacheline are vulnerable to ITS, the "
"basic idea behind the mitigation is to not allow indirect branches in the "
"lower half."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:61
msgid ""
"This is achieved by relying on existing retpoline support in the kernel, and "
"in compilers. ITS-vulnerable retpoline sites are runtime patched to point to "
"newly added ITS-safe thunks. These safe thunks consists of indirect branch "
"in the second half of the cacheline. Not all retpoline sites are patched to "
"thunks, if a retpoline site is evaluated to be ITS-safe, it is replaced with "
"an inline indirect branch."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:69
msgid "Dynamic thunks"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:70
msgid ""
"From a dynamically allocated pool of safe-thunks, each vulnerable site is "
"replaced with a new thunk, such that they get a unique address. This could "
"improve the branch prediction accuracy. Also, it is a defense-in-depth "
"measure against aliasing."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:75
msgid ""
"Note, for simplicity, indirect branches in eBPF programs are always replaced "
"with a jump to a static thunk in __x86_indirect_its_thunk_array. If "
"required, in future this can be changed to use dynamic thunks."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:79
msgid ""
"All vulnerable RETs are replaced with a static thunk, they do not use "
"dynamic thunks. This is because RETs get their prediction from RSB mostly "
"that does not depend on source address. RETs that underflow RSB may benefit "
"from dynamic thunks. But, RETs significantly outnumber indirect branches, "
"and any benefit from a unique source address could be outweighed by the "
"increased icache footprint and iTLB pressure."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:87
msgid "Retpoline"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:88
msgid ""
"Retpoline sequence also mitigates ITS-unsafe indirect branches. For this "
"reason, when retpoline is enabled, ITS mitigation only relocates the RETs to "
"safe thunks. Unless user requested the RSB-stuffing mitigation."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:93
msgid "RSB Stuffing"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:94
msgid ""
"RSB-stuffing via Call Depth Tracking is a mitigation for Retbleed RSB-"
"underflow attacks. And it also mitigates RETs that are vulnerable to ITS."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:98
msgid "Mitigation in guests"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:99
msgid ""
"All guests deploy ITS mitigation by default, irrespective of eIBRS "
"enumeration and Family/Model of the guest. This is because eIBRS feature "
"could be hidden from a guest. One exception to this is when a guest "
"enumerates BHI_DIS_S, which indicates that the guest is running on an "
"unaffected host."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:104
msgid ""
"To prevent guests from unnecessarily deploying the mitigation on unaffected "
"platforms, Intel has defined ITS_NO bit(62) in MSR IA32_ARCH_CAPABILITIES. "
"When a guest sees this bit set, it should not enumerate the ITS bug. Note, "
"this bit is not set by any hardware, but is **intended for VMMs to "
"synthesize** it for guests as per the host's affected status."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:111
msgid "Mitigation options"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:112
msgid ""
"The ITS mitigation can be controlled using the \"indirect_target_selection\" "
"kernel parameter. The available options are:"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:116
msgid "on"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:116
msgid ""
"(default)  Deploy the \"Aligned branch/return thunks\" mitigation. If "
"spectre_v2 mitigation enables retpoline, aligned-thunks are only deployed "
"for the affected RET instructions. Retpoline mitigates indirect branches."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:121
msgid "off"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:121
msgid "Disable ITS mitigation."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:123
msgid "vmexit"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:123
msgid ""
"Equivalent to \"=on\" if the CPU is affected by guest/host isolation part of "
"ITS. Otherwise, mitigation is not deployed. This option is useful when host "
"userspace is not in the threat model, and only attacks from guest to host "
"are considered."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:128
msgid "stuff"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:128
msgid ""
"Deploy RSB-fill mitigation when retpoline is also deployed. Otherwise, "
"deploy the default mitigation. When retpoline mitigation is enabled, RSB-"
"stuffing via Call-Depth-Tracking also mitigates ITS."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:133
msgid "force"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:133
msgid "Force the ITS bug and deploy the default mitigation."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:137
msgid "Sysfs reporting"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:139
msgid "The sysfs file showing ITS mitigation status is:"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:141
msgid "/sys/devices/system/cpu/vulnerabilities/indirect_target_selection"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:143
msgid "Note, microcode mitigation status is not reported in this file."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:145
msgid "The possible values in this file are:"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:150
msgid "The processor is not vulnerable."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:151
msgid "Vulnerable"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:152
msgid "System is vulnerable and no mitigation has been applied."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:153
msgid "Vulnerable, KVM: Not affected"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:154
msgid ""
"System is vulnerable to intra-mode BTI, but not affected by eIBRS guest/host "
"isolation."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:156
msgid "Mitigation: Aligned branch/return thunks"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:157
msgid ""
"The mitigation is enabled, affected indirect branches and RETs are relocated "
"to safe thunks."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:159
msgid "Mitigation: Retpolines, Stuffing RSB"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:160
msgid "The mitigation is enabled using retpoline and RSB stuffing."
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:163
msgid "References"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:164
msgid ""
"Microcode repository - https://github.com/intel/Intel-Linux-Processor-"
"Microcode-Data-Files"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:166
msgid ""
"Affected Processors list - https://www.intel.com/content/www/us/en/developer/"
"topic-technology/software-security-guidance/processors-affected-consolidated-"
"product-cpu-model.html"
msgstr ""

#: ../../../admin-guide/hw-vuln/indirect-target-selection.rst:168
msgid ""
"Affected Processors list (machine readable) - https://github.com/intel/Intel-"
"affected-processor-list"
msgstr ""

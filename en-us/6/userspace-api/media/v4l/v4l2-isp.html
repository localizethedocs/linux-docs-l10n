<!DOCTYPE html>

<html lang="en-US" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.13.15. Generic V4L2 ISP formats &#8212; The Linux Kernel unknown version documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=adfc0c0d" />
    <script src="../../../_static/documentation_options.js?v=750ed68d"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/linux-docs-l10n/userspace-api/media/v4l/v4l2-isp.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="2.14. Reserved Format Identifiers" href="pixfmt-reserved.html" />
    <link rel="prev" title="2.13.14. V4L2_META_FMT_VSP1_HGT (‘VSPT’)" href="metafmt-vsp1-hgt.html" />

   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

<script type="text/javascript" src="../../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../../ltd-flyout.js"></script>

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/logo.svg" alt="Logo of The Linux Kernel"/>
            </a></p>
<h1 class="logo"><a href="../../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.19.0</p>







<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>


<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../process/submitting-patches.html">Submitting patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../process/code-of-conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../maintainer/index.html">Maintainer handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../process/index.html">All development-process docs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../core-api/index.html">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../driver-api/index.html">Driver APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../subsystem-apis.html">Subsystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc-guide/index.html">Writing documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev-tools/index.html">Development tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev-tools/testing-overview.html">Testing guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../livepatch/index.html">Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rust/index.html">Rust</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../admin-guide/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../kbuild/index.html">Build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../admin-guide/reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/index.html">Userspace tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Userspace API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../index.html#system-calls">System calls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#security-related-interfaces">Security-related interfaces</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html#devices-and-i-o">Devices and I/O</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../accelerators/ocxl.html">OpenCAPI (Open Coherent Accelerator Processor Interface)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dma-buf-heaps.html">Allocating dma-buf using heaps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dma-buf-alloc-exchange.html">Exchanging pixel buffers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fwctl/index.html">Firmware Control (FWCTL) Userspace API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../gpio/index.html">GPIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../iommufd.html">IOMMUFD</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">Linux Media Infrastructure userspace API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dcdbas.html">Dell Systems Management Base Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vduse.html">VDUSE - “vDPA Device in Userspace”</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../isapnp.html">ISA Plug &amp; Play support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#everything-else">Everything else</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../firmware-guide/index.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../devicetree/index.html">Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../arch/index.html">CPU architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../staging/index.html">Unsorted documentation</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/userspace-api/media/v4l/v4l2-isp.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="generic-v4l2-isp-formats">
<span id="v4l2-isp"></span><h1><span class="section-number">2.13.15. </span>Generic V4L2 ISP formats<a class="headerlink" href="#generic-v4l2-isp-formats" title="Link to this heading">¶</a></h1>
<p>Generic ISP formats are metadata formats that define a mechanism to pass ISP
parameters and statistics between userspace and drivers in V4L2 buffers. They
are designed to allow extending them in a backward-compatible way.</p>
<section id="isp-parameters">
<h2><span class="section-number">2.13.15.1. </span>ISP parameters<a class="headerlink" href="#isp-parameters" title="Link to this heading">¶</a></h2>
<p>The generic ISP configuration parameters format is realized by a defining a
single C structure that contains a header, followed by a binary buffer where
userspace programs a variable number of ISP configuration data block, one for
each supported ISP feature.</p>
<p>The <a class="reference internal" href="#c.v4l2_isp_params_buffer" title="v4l2_isp_params_buffer"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_isp_params_buffer</span></code></a> structure defines the buffer header which
is followed by a binary buffer of ISP configuration data. Userspace shall
correctly populate the buffer header with the generic parameters format version
and with the size (in bytes) of the binary data buffer where it will store the
ISP blocks configuration.</p>
<p>Each <em>ISP configuration block</em> is preceded by an header implemented by the
<a class="reference internal" href="#c.v4l2_isp_params_block_header" title="v4l2_isp_params_block_header"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_isp_params_block_header</span></code></a> structure, followed by the configuration
parameters for that specific block, defined by the ISP driver specific data
types.</p>
<p>Userspace applications are responsible for correctly populating each block’s
header fields (type, flags and size) and the block-specific parameters.</p>
<section id="isp-block-enabling-disabling-and-configuration">
<h3><span class="section-number">2.13.15.1.1. </span>ISP block enabling, disabling and configuration<a class="headerlink" href="#isp-block-enabling-disabling-and-configuration" title="Link to this heading">¶</a></h3>
<p>When userspace wants to configure and enable an ISP block it shall fully
populate the block configuration and set the V4L2_ISP_PARAMS_FL_BLOCK_ENABLE
bit in the block header’s <cite>flags</cite> field.</p>
<p>When userspace simply wants to disable an ISP block the
V4L2_ISP_PARAMS_FL_BLOCK_DISABLE bit should be set in block header’s <cite>flags</cite>
field. Drivers accept a configuration parameters block with no additional
data after the header in this case.</p>
<p>If the configuration of an already active ISP block has to be updated,
userspace shall fully populate the ISP block parameters and omit setting the
V4L2_ISP_PARAMS_FL_BLOCK_ENABLE and V4L2_ISP_PARAMS_FL_BLOCK_DISABLE bits in the
header’s <cite>flags</cite> field.</p>
<p>Setting both the V4L2_ISP_PARAMS_FL_BLOCK_ENABLE and
V4L2_ISP_PARAMS_FL_BLOCK_DISABLE bits in the flags field is not allowed and
returns an error.</p>
<p>Extension to the parameters format can be implemented by adding new blocks
definition without invalidating the existing ones.</p>
</section>
</section>
<section id="isp-statistics">
<h2><span class="section-number">2.13.15.2. </span>ISP statistics<a class="headerlink" href="#isp-statistics" title="Link to this heading">¶</a></h2>
<p>Support for generic statistics format is not yet implemented in Video4Linux2.</p>
</section>
<section id="v4l2-isp-uapi-data-types">
<h2><span class="section-number">2.13.15.3. </span>V4L2 ISP uAPI data types<a class="headerlink" href="#v4l2-isp-uapi-data-types" title="Link to this heading">¶</a></h2>
<dl class="c enum">
<dt class="sig sig-object c" id="c.v4l2_isp_params_version">
<span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">v4l2_isp_params_version</span></span></span><a class="headerlink" href="#c.v4l2_isp_params_version" title="Link to this definition">¶</a><br /></dt>
<dd><p>V4L2 ISP parameters versioning</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Constants</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">V4L2_ISP_PARAMS_VERSION_V0</span></code></dt><dd><p>First version of the V4L2 ISP parameters format
(for compatibility)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">V4L2_ISP_PARAMS_VERSION_V1</span></code></dt><dd><p>First version of the V4L2 ISP parameters format</p>
</dd>
</dl>
</div>
<p><strong>Description</strong></p>
<p>V0 and V1 are identical in order to support drivers compatible with the V4L2
ISP parameters format already upstreamed which use either 0 or 1 as their
versioning identifier. Both V0 and V1 refers to the first version of the
V4L2 ISP parameters format.</p>
<p>Future revisions of the V4L2 ISP parameters format should start from the
value of 2.</p>
<dl class="c struct">
<dt class="sig sig-object c" id="c.v4l2_isp_params_block_header">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">v4l2_isp_params_block_header</span></span></span><a class="headerlink" href="#c.v4l2_isp_params_block_header" title="Link to this definition">¶</a><br /></dt>
<dd><p>V4L2 extensible parameters block header</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct v4l2_isp_params_block_header {
    __u16 type;
    __u16 flags;
    __u32 size;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">type</span></code></dt><dd><p>The parameters block type (driver-specific)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">flags</span></code></dt><dd><p>A bitmask of block flags (driver-specific)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">size</span></code></dt><dd><p>Size (in bytes) of the parameters block, including this header</p>
</dd>
</dl>
</div>
<p><strong>Description</strong></p>
<p>This structure represents the common part of all the ISP configuration
blocks. Each parameters block shall embed an instance of this structure type
as its first member, followed by the block-specific configuration data.</p>
<p>The <strong>type</strong> field is an ISP driver-specific value that identifies the block
type. The <strong>size</strong> field specifies the size of the parameters block.</p>
<p>The <strong>flags</strong> field is a bitmask of per-block flags V4L2_PARAMS_ISP_FL_* and
driver-specific flags specified by the driver header.</p>
<dl class="c struct">
<dt class="sig sig-object c" id="c.v4l2_isp_params_buffer">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">v4l2_isp_params_buffer</span></span></span><a class="headerlink" href="#c.v4l2_isp_params_buffer" title="Link to this definition">¶</a><br /></dt>
<dd><p>V4L2 extensible parameters configuration</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct v4l2_isp_params_buffer {
    __u32 version;
    __u32 data_size;
    __u8 data[] ;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">version</span></code></dt><dd><p>The parameters buffer version (driver-specific)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">data_size</span></code></dt><dd><p>The configuration data effective size, excluding this header</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">data</span></code></dt><dd><p>The configuration data</p>
</dd>
</dl>
</div>
<p><strong>Description</strong></p>
<p>This structure contains the configuration parameters of the ISP algorithms,
serialized by userspace into a data buffer. Each configuration parameter
block is represented by a block-specific structure which contains a
<a class="reference internal" href="#c.v4l2_isp_params_block_header" title="v4l2_isp_params_block_header"><code class="xref c c-type docutils literal notranslate"><span class="pre">v4l2_isp_params_block_header</span></code></a> entry as first member. Userspace
populates the <strong>data</strong> buffer with configuration parameters for the blocks that
it intends to configure. As a consequence, the data buffer effective size
changes according to the number of ISP blocks that userspace intends to
configure and is set by userspace in the <strong>data_size</strong> field.</p>
<p>The parameters buffer is versioned by the <strong>version</strong> field to allow modifying
and extending its definition. Userspace shall populate the <strong>version</strong> field to
inform the driver about the version it intends to use. The driver will parse
and handle the <strong>data</strong> buffer according to the data layout specific to the
indicated version and return an error if the desired version is not
supported.</p>
<p>For each ISP block that userspace wants to configure, a block-specific
structure is appended to the <strong>data</strong> buffer, one after the other without gaps
in between. Userspace shall populate the <strong>data_size</strong> field with the effective
size, in bytes, of the <strong>data</strong> buffer.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;The kernel development community.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../../_sources/userspace-api/media/v4l/v4l2-isp.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
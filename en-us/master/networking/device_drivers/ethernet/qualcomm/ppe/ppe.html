<!DOCTYPE html>

<html lang="en-US" data-content_root="../../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PPE Ethernet Driver for Qualcomm IPQ SoC Family &#8212; The Linux Kernel unknown version documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/alabaster.css?v=adfc0c0d" />
    <script src="../../../../../_static/documentation_options.js?v=750ed68d"></script>
    <script src="../../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/linux-docs-l10n/networking/device_drivers/ethernet/qualcomm/ppe/ppe.html" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="SMC 9xxxx Driver" href="../../smsc/smc9.html" />
    <link rel="prev" title="RDMA Driver for the AMD Pensando(R) Ethernet adapter family" href="../../pensando/ionic_rdma.html" />

   
  <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
  

  
  

<script type="text/javascript" src="../../../../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../../../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../../../../ltd-flyout.js"></script>

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../../index.html">
              <img class="logo" src="../../../../../_static/logo.svg" alt="Logo of The Linux Kernel"/>
            </a></p>
<h1 class="logo"><a href="../../../../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.19.0</p>







<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>


<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../process/submitting-patches.html">Submitting patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../process/code-of-conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../maintainer/index.html">Maintainer handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../process/index.html">All development-process docs</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../core-api/index.html">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../driver-api/index.html">Driver APIs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../../subsystem-apis.html">Subsystems</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../../subsystem-apis.html#core-subsystems">Core subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../subsystem-apis.html#human-interfaces">Human interfaces</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../../../subsystem-apis.html#networking-interfaces">Networking interfaces</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../../../index.html">Networking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../isdn/index.html">ISDN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../mhi/index.html">MHI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../subsystem-apis.html#storage-interfaces">Storage interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../subsystem-apis.html#other-subsystems">Other subsystems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../doc-guide/index.html">Writing documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../dev-tools/index.html">Development tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../dev-tools/testing-overview.html">Testing guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../livepatch/index.html">Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../rust/index.html">Rust</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../admin-guide/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../kbuild/index.html">Build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../admin-guide/reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../tools/index.html">Userspace tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../userspace-api/index.html">Userspace API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../firmware-guide/index.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../devicetree/index.html">Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../arch/index.html">CPU architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../staging/index.html">Unsorted documentation</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../../_sources/networking/device_drivers/ethernet/qualcomm/ppe/ppe.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="ppe-ethernet-driver-for-qualcomm-ipq-soc-family">
<h1>PPE Ethernet Driver for Qualcomm IPQ SoC Family<a class="headerlink" href="#ppe-ethernet-driver-for-qualcomm-ipq-soc-family" title="Link to this heading">¶</a></h1>
<p>Copyright (c) Qualcomm Technologies, Inc. and/or its subsidiaries.</p>
<p>Author: Lei Wei &lt;<a class="reference external" href="mailto:quic_leiwei&#37;&#52;&#48;quicinc&#46;com">quic_leiwei<span>&#64;</span>quicinc<span>&#46;</span>com</a>&gt;</p>
<section id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#ppe-overview">PPE Overview</a></p></li>
<li><p><a class="reference internal" href="#ppe-driver-overview">PPE Driver Overview</a></p></li>
<li><p><a class="reference internal" href="#ppe-driver-supported-socs">PPE Driver Supported SoCs</a></p></li>
<li><p><a class="reference internal" href="#enabling-the-driver">Enabling the Driver</a></p></li>
<li><p><a class="reference internal" href="#debugging">Debugging</a></p></li>
</ul>
</section>
<section id="ppe-overview">
<h2>PPE Overview<a class="headerlink" href="#ppe-overview" title="Link to this heading">¶</a></h2>
<p>IPQ (Qualcomm Internet Processor) SoC (System-on-Chip) series is Qualcomm’s series of
networking SoC for Wi-Fi access points. The PPE (Packet Process Engine) is the Ethernet
packet process engine in the IPQ SoC.</p>
<p>Below is a simplified hardware diagram of IPQ9574 SoC which includes the PPE engine and
other blocks which are in the SoC but outside the PPE engine. These blocks work together
to enable the Ethernet for the IPQ SoC:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>              +------+ +------+ +------+ +------+ +------+  +------+ start +-------+
              |netdev| |netdev| |netdev| |netdev| |netdev|  |netdev|&lt;------|PHYLINK|
              +------+ +------+ +------+ +------+ +------+  +------+ stop  +-+-+-+-+
                                            |                                | | ^
+-------+     +-------------------------+--------+----------------------+    | | |
| GCC   |     |                         |  EDMA  |                      |    | | |
+---+---+     |  PPE                    +---+----+                      |    | | |
    | clk     |                             |                           |    | | |
    +--------&gt;| +-----------------------+------+-----+---------------+  |    | | |
              | |   Switch Core         |Port0 |     |Port7(EIP FIFO)|  |    | | |
              | |                       +---+--+     +------+--------+  |    | | |
              | |                           |               |        |  |    | | |
+-------+     | |                    +------+---------------+----+   |  |    | | |
|CMN PLL|     | | +---+ +---+ +----+ | +--------+                |   |  |    | | |
+---+---+     | | |BM | |QM | |SCH | | | L2/L3  |  .......       |   |  |    | | |
|   |         | | +---+ +---+ +----+ | +--------+                |   |  |    | | |
|   |         | |                    +------+--------------------+   |  |    | | |
|   |         | |                           |                        |  |    | | |
|   v         | | +-----+-+-----+-+-----+-+-+---+--+-----+-+-----+   |  |    | | |
| +------+    | | |Port1| |Port2| |Port3| |Port4|  |Port5| |Port6|   |  |    | | |
| |NSSCC |    | | +-----+ +-----+ +-----+ +-----+  +-----+ +-----+   |  | mac| | |
| +-+-+--+    | | |MAC0 | |MAC1 | |MAC2 | |MAC3 |  |MAC4 | |MAC5 |   |  |&lt;---+ | |
| ^ | |clk    | | +-----+-+-----+-+-----+-+-----+--+-----+-+-----+   |  | ops  | |
| | | +------&gt;| +----|------|-------|-------|---------|--------|-----+  |      | |
| | |         +---------------------------------------------------------+      | |
| | |                |      |       |       |         |        |               | |
| | |   MII clk      |      QSGMII               USXGMII   USXGMII             | |
| | +---------------&gt;|      |       |       |         |        |               | |
| |                +-------------------------+ +---------+ +---------+         | |
| |125/312.5MHz clk|       (PCS0)            | | (PCS1)  | | (PCS2)  | pcs ops | |
| +----------------+       UNIPHY0           | | UNIPHY1 | | UNIPHY2 |&lt;--------+ |
+-----------------&gt;|                         | |         | |         |           |
| 31.25MHz ref clk +-------------------------+ +---------+ +---------+           |
|                     |     |      |      |          |          |                |
|                +-----------------------------------------------------+         |
|25/50MHz ref clk| +-------------------------+    +------+   +------+  | link    |
+---------------&gt;| |      QUAD PHY           |    | PHY4 |   | PHY5 |  |---------+
                 | +-------------------------+    +------+   +------+  | change
                 |                                                     |
                 |                       MDIO bus                      |
                 +-----------------------------------------------------+
</pre></div>
</div>
<p>The CMN (Common) PLL, NSSCC (Networking Sub System Clock Controller) and GCC (Global
Clock Controller) blocks are in the SoC and act as clock providers.</p>
<p>The UNIPHY block is in the SoC and provides the PCS (Physical Coding Sublayer) and
XPCS (10-Gigabit Physical Coding Sublayer) functions to support different interface
modes between the PPE MAC and the external PHY.</p>
<p>This documentation focuses on the descriptions of PPE engine and the PPE driver.</p>
<p>The Ethernet functionality in the PPE (Packet Process Engine) is comprised of three
components: the switch core, port wrapper and Ethernet DMA.</p>
<p>The Switch core in the IPQ9574 PPE has maximum of 6 front panel ports and two FIFO
interfaces. One of the two FIFO interfaces is used for Ethernet port to host CPU
communication using Ethernet DMA. The other one is used to communicate to the EIP
engine which is used for IPsec offload. On the IPQ9574, the PPE includes 6 GMAC/XGMACs
that can be connected with external Ethernet PHY. Switch core also includes BM (Buffer
Management), QM (Queue Management) and SCH (Scheduler) modules for supporting the
packet processing.</p>
<p>The port wrapper provides connections from the 6 GMAC/XGMACS to UNIPHY (PCS) supporting
various modes such as SGMII/QSGMII/PSGMII/USXGMII/10G-BASER. There are 3 UNIPHY (PCS)
instances supported on the IPQ9574.</p>
<p>Ethernet DMA is used to transmit and receive packets between the Ethernet subsystem
and ARM host CPU.</p>
<p>The following lists the main blocks in the PPE engine which will be driven by this
PPE driver:</p>
<ul class="simple">
<li><dl class="simple">
<dt>BM</dt><dd><p>BM is the hardware buffer manager for the PPE switch ports.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>QM</dt><dd><p>Queue Manager for managing the egress hardware queues of the PPE switch ports.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>SCH</dt><dd><p>The scheduler which manages the hardware traffic scheduling for the PPE switch ports.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>L2</dt><dd><p>The L2 block performs the packet bridging in the switch core. The bridge domain is
represented by the VSI (Virtual Switch Instance) domain in PPE. FDB learning can be
enabled based on the VSI domain and bridge forwarding occurs within the VSI domain.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>MAC</dt><dd><p>The PPE in the IPQ9574 supports up to six MACs (MAC0 to MAC5) which are corresponding
to six switch ports (port1 to port6). The MAC block is connected with external PHY
through the UNIPHY PCS block. Each MAC block includes the GMAC and XGMAC blocks and
the switch port can select to use GMAC or XMAC through a MUX selection according to
the external PHY’s capability.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>EDMA (Ethernet DMA)</dt><dd><p>The Ethernet DMA is used to transmit and receive Ethernet packets between the PPE
ports and the ARM cores.</p>
</dd>
</dl>
</li>
</ul>
<p>The received packet on a PPE MAC port can be forwarded to another PPE MAC port. It can
be also forwarded to internal switch port0 so that the packet can be delivered to the
ARM cores using the Ethernet DMA (EDMA) engine. The Ethernet DMA driver will deliver the
packet to the corresponding ‘netdevice’ interface.</p>
<p>The software instantiations of the PPE MAC (netdevice), PCS and external PHYs interact
with the Linux PHYLINK framework to manage the connectivity between the PPE ports and
the connected PHYs, and the port link states. This is also illustrated in above diagram.</p>
</section>
<section id="ppe-driver-overview">
<h2>PPE Driver Overview<a class="headerlink" href="#ppe-driver-overview" title="Link to this heading">¶</a></h2>
<p>PPE driver is Ethernet driver for the Qualcomm IPQ SoC. It is a single platform driver
which includes the PPE part and Ethernet DMA part. The PPE part initializes and drives the
various blocks in PPE switch core such as BM/QM/L2 blocks and the PPE MACs. The EDMA part
drives the Ethernet DMA for packet transfer between PPE ports and ARM cores, and enables
the netdevice driver for the PPE ports.</p>
<p>The PPE driver files in drivers/net/ethernet/qualcomm/ppe/ are listed as below:</p>
<ul class="simple">
<li><p>Makefile</p></li>
<li><p>ppe.c</p></li>
<li><p>ppe.h</p></li>
<li><p>ppe_config.c</p></li>
<li><p>ppe_config.h</p></li>
<li><p>ppe_debugfs.c</p></li>
<li><p>ppe_debugfs.h</p></li>
<li><p>ppe_regs.h</p></li>
</ul>
<p>The ppe.c file contains the main PPE platform driver and undertakes the initialization of
PPE switch core blocks such as QM, BM and L2. The configuration APIs for these hardware
blocks are provided in the ppe_config.c file.</p>
<p>The ppe.h defines the PPE device data structure which will be used by PPE driver functions.</p>
<p>The ppe_debugfs.c enables the PPE statistics counters such as PPE port Rx and Tx counters,
CPU code counters and queue counters.</p>
</section>
<section id="ppe-driver-supported-socs">
<h2>PPE Driver Supported SoCs<a class="headerlink" href="#ppe-driver-supported-socs" title="Link to this heading">¶</a></h2>
<p>The PPE driver supports the following IPQ SoC:</p>
<ul class="simple">
<li><p>IPQ9574</p></li>
</ul>
</section>
<section id="enabling-the-driver">
<h2>Enabling the Driver<a class="headerlink" href="#enabling-the-driver" title="Link to this heading">¶</a></h2>
<p>The driver is located in the menu structure at:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-&gt; Device Drivers
  -&gt; Network device support (NETDEVICES [=y])
    -&gt; Ethernet driver support
      -&gt; Qualcomm devices
        -&gt; Qualcomm Technologies, Inc. PPE Ethernet support
</pre></div>
</div>
<p>If the driver is built as a module, the module will be called qcom-ppe.</p>
<p>The PPE driver functionally depends on the CMN PLL and NSSCC clock controller drivers.
Please make sure the dependent modules are installed before installing the PPE driver
module.</p>
</section>
<section id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Link to this heading">¶</a></h2>
<p>The PPE hardware counters can be accessed using debugfs interface from the
<code class="docutils literal notranslate"><span class="pre">/sys/kernel/debug/ppe/</span></code> directory.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;The kernel development community.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../../../../_sources/networking/device_drivers/ethernet/qualcomm/ppe/ppe.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
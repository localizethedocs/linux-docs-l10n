<!DOCTYPE html>

<html lang="en-US" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Execution Queue &#8212; The Linux Kernel unknown version documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=adfc0c0d" />
    <script src="../../_static/documentation_options.js?v=750ed68d"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/linux-docs-l10n/gpu/xe/xe_exec_queue.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Command submission" href="xe_cs.html" />
    <link rel="prev" title="Migrate Layer" href="xe_migrate.html" />

   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

<script type="text/javascript" src="../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../ltd-flyout.js"></script>

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.svg" alt="Logo of The Linux Kernel"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.19.0</p>







<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>


<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/submitting-patches.html">Submitting patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/code-of-conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">Maintainer handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">All development-process docs</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">Driver APIs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../subsystem-apis.html">Subsystems</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../subsystem-apis.html#core-subsystems">Core subsystems</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../subsystem-apis.html#human-interfaces">Human interfaces</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../input/index.html">Input Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sound/index.html">Sound Subsystem Documentation</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">GPU Driver Developer’s Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../leds/index.html">LEDs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../subsystem-apis.html#networking-interfaces">Networking interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../subsystem-apis.html#storage-interfaces">Storage interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../subsystem-apis.html#other-subsystems">Other subsystems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">Writing documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">Development tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/testing-overview.html">Testing guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../livepatch/index.html">Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rust/index.html">Rust</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kbuild/index.html">Build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Userspace tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../userspace-api/index.html">Userspace API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicetree/index.html">Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arch/index.html">CPU architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html">Unsorted documentation</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/gpu/xe/xe_exec_queue.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="execution-queue">
<h1>Execution Queue<a class="headerlink" href="#execution-queue" title="Link to this heading">¶</a></h1>
<p>An Execution queue is an interface for the HW context of execution.
The user creates an execution queue, submits the GPU jobs through those
queues and in the end destroys them.</p>
<p>Execution queues can also be created by XeKMD itself for driver internal
operations like object migration etc.</p>
<p>An execution queue is associated with a specified HW engine or a group of
engines (belonging to the same tile and engine class) and any GPU job
submitted on the queue will be run on one of these engines.</p>
<p>An execution queue is tied to an address space (VM). It holds a reference
of the associated VM and the underlying Logical Ring Context/s (LRC/s)
until the queue is destroyed.</p>
<p>The execution queue sits on top of the submission backend. It opaquely
handles the GuC and Execlist backends whichever the platform uses, and
the ring operations the different engine classes support.</p>
<section id="internal-api">
<h2>Internal API<a class="headerlink" href="#internal-api" title="Link to this heading">¶</a></h2>
<dl class="c struct">
<dt class="sig sig-object c" id="c.xe_exec_queue">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue</span></span></span><a class="headerlink" href="#c.xe_exec_queue" title="Link to this definition">¶</a><br /></dt>
<dd><p>Execution queue</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct xe_exec_queue {
    struct xe_file *xef;
    struct xe_gt *gt;
    struct xe_hw_engine *hwe;
    struct kref refcount;
    struct xe_vm *vm;
    struct xe_vm *user_vm;
    enum xe_engine_class class;
    u32 logical_mask;
    char name[MAX_FENCE_NAME_LEN];
    u16 width;
    u16 msix_vec;
    struct xe_hw_fence_irq *fence_irq;
    struct dma_fence *last_fence;
#define EXEC_QUEUE_FLAG_KERNEL                  BIT(0);
#define EXEC_QUEUE_FLAG_PERMANENT               BIT(1);
#define EXEC_QUEUE_FLAG_VM                      BIT(2);
#define EXEC_QUEUE_FLAG_BIND_ENGINE_CHILD       BIT(3);
#define EXEC_QUEUE_FLAG_HIGH_PRIORITY           BIT(4);
#define EXEC_QUEUE_FLAG_LOW_LATENCY             BIT(5);
#define EXEC_QUEUE_FLAG_MIGRATE                 BIT(6);
    unsigned long flags;
    union {
        struct list_head multi_gt_list;
        struct list_head multi_gt_link;
    };
    union {
        struct xe_execlist_exec_queue *execlist;
        struct xe_guc_exec_queue *guc;
    };
    struct {
        u32 timeslice_us;
        u32 preempt_timeout_us;
        u32 job_timeout_ms;
        enum xe_exec_queue_priority priority;
    } sched_props;
    struct {
        struct dma_fence *pfence;
        u64 context;
        u32 seqno;
        struct list_head link;
    } lr;
#define XE_EXEC_QUEUE_TLB_INVAL_PRIMARY_GT      0;
#define XE_EXEC_QUEUE_TLB_INVAL_MEDIA_GT        1;
#define XE_EXEC_QUEUE_TLB_INVAL_COUNT           (XE_EXEC_QUEUE_TLB_INVAL_MEDIA_GT  + 1);
    struct {
        struct xe_dep_scheduler *dep_scheduler;
        struct dma_fence *last_fence;
    } tlb_inval[XE_EXEC_QUEUE_TLB_INVAL_COUNT];
    struct {
        u8 type;
        struct list_head link;
    } pxp;
    struct drm_syncobj *ufence_syncobj;
    u64 ufence_timeline_value;
    const struct xe_exec_queue_ops *ops;
    const struct xe_ring_ops *ring_ops;
    struct drm_sched_entity *entity;
#define XE_MAX_JOB_COUNT_PER_EXEC_QUEUE 1000;
    atomic_t job_cnt;
    u64 tlb_flush_seqno;
    struct list_head hw_engine_group_link;
    struct xe_lrc *lrc[] ;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">xef</span></code></dt><dd><p>Back pointer to xe file if this is user created exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">gt</span></code></dt><dd><p>GT structure this exec queue can submit to</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">hwe</span></code></dt><dd><p>A hardware of the same class. May (physical engine) or may not
(virtual engine) be where jobs actual engine up running. Should never
really be used for submissions.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">refcount</span></code></dt><dd><p>ref count of this exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">vm</span></code></dt><dd><p>VM (address space) for this exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">user_vm</span></code></dt><dd><p>User VM (address space) for this exec queue (bind queues
only)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">class</span></code></dt><dd><p>class of this exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">logical_mask</span></code></dt><dd><p>logical mask of where job submitted to exec queue can run</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">name</span></code></dt><dd><p>name of this exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">width</span></code></dt><dd><p>width (number BB submitted per exec) of this exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">msix_vec</span></code></dt><dd><p>MSI-X vector (for platforms that support it)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">fence_irq</span></code></dt><dd><p>fence IRQ used to signal job completion</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">last_fence</span></code></dt><dd><p>last fence for tlb invalidation, protected by
vm-&gt;lock in write mode</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">flags</span></code></dt><dd><p>flags for this exec queue, should statically setup aside from ban
bit</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">{unnamed_union}</span></code></dt><dd><p>anonymous</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">multi_gt_list</span></code></dt><dd><p>list head for VM bind engines if multi-GT</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">multi_gt_link</span></code></dt><dd><p>link for VM bind engines if multi-GT</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">{unnamed_union}</span></code></dt><dd><p>anonymous</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">execlist</span></code></dt><dd><p>execlist backend specific state for exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">guc</span></code></dt><dd><p>GuC backend specific state for exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">sched_props</span></code></dt><dd><p>scheduling properties</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">lr</span></code></dt><dd><p>long-running exec queue state</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">tlb_inval</span></code></dt><dd><p>TLB invalidations exec queue state</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">tlb_inval.dep_scheduler</span></code></dt><dd><p>The TLB invalidation
dependency scheduler</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">pxp</span></code></dt><dd><p>PXP info tracking</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ufence_syncobj</span></code></dt><dd><p>User fence syncobj</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ufence_timeline_value</span></code></dt><dd><p>User fence timeline value</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ops</span></code></dt><dd><p>submission backend exec queue operations</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ring_ops</span></code></dt><dd><p>ring operations for this exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">entity</span></code></dt><dd><p>DRM sched entity for this exec queue (1 to 1 relationship)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">job_cnt</span></code></dt><dd><p>number of drm jobs in this exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">tlb_flush_seqno</span></code></dt><dd><p>The seqno of the last rebind tlb flush performed
Protected by <strong>vm</strong>’s resv. Unused if <strong>vm</strong> == NULL.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">hw_engine_group_link</span></code></dt><dd><p>link into exec queues in the same hw engine group</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">lrc</span></code></dt><dd><p>logical ring context for this exec queue</p>
</dd>
</dl>
</div>
<p><strong>Description</strong></p>
<p>Contains all state necessary for submissions. Can either be a user object or
a kernel object.</p>
<dl class="c struct">
<dt class="sig sig-object c" id="c.xe_exec_queue_ops">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_ops</span></span></span><a class="headerlink" href="#c.xe_exec_queue_ops" title="Link to this definition">¶</a><br /></dt>
<dd><p>Submission backend exec queue operations</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Definition</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>struct xe_exec_queue_ops {
    int (*init)(struct xe_exec_queue *q);
    void (*kill)(struct xe_exec_queue *q);
    void (*fini)(struct xe_exec_queue *q);
    void (*destroy)(struct xe_exec_queue *q);
    int (*set_priority)(struct xe_exec_queue *q, enum xe_exec_queue_priority priority);
    int (*set_timeslice)(struct xe_exec_queue *q, u32 timeslice_us);
    int (*set_preempt_timeout)(struct xe_exec_queue *q, u32 preempt_timeout_us);
    int (*suspend)(struct xe_exec_queue *q);
    int (*suspend_wait)(struct xe_exec_queue *q);
    void (*resume)(struct xe_exec_queue *q);
    bool (*reset_status)(struct xe_exec_queue *q);
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">init</span></code></dt><dd><p>Initialize exec queue for submission backend</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">kill</span></code></dt><dd><p>Kill inflight submissions for backend</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">fini</span></code></dt><dd><p>Undoes the <code class="xref c c-func broken_xref docutils literal notranslate"><span class="pre">init()</span></code> for submission backend</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">destroy</span></code></dt><dd><p>Destroy exec queue for submission backend. The backend
function must call <code class="xref c c-func broken_xref docutils literal notranslate"><span class="pre">xe_exec_queue_fini()</span></code> (which will in turn call the
<code class="xref c c-func broken_xref docutils literal notranslate"><span class="pre">fini()</span></code> backend function) to ensure the queue is properly cleaned up.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">set_priority</span></code></dt><dd><p>Set priority for exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">set_timeslice</span></code></dt><dd><p>Set timeslice for exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">set_preempt_timeout</span></code></dt><dd><p>Set preemption timeout for exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">suspend</span></code></dt><dd><p>Suspend exec queue from executing, allowed to be called
multiple times in a row before resume with the caveat that
suspend_wait returns before calling suspend again.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">suspend_wait</span></code></dt><dd><p>Wait for an exec queue to suspend executing, should be
call after suspend. In dma-fencing path thus must return within a
reasonable amount of time. -ETIME return shall indicate an error
waiting for suspend resulting in associated VM getting killed.
-EAGAIN return indicates the wait should be tried again, if the wait
is within a work item, the work item should be requeued as deadlock
avoidance mechanism.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">resume</span></code></dt><dd><p>Resume exec queue execution, exec queue must be in a suspended
state and dma fence returned from most recent suspend call must be
signalled when this function is called.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">reset_status</span></code></dt><dd><p>check exec queue reset status</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_create_bind">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_create_bind</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xe_device</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">xe</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xe_tile</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tile</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xe_vm</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">user_vm</span></span>, <span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="n"><span class="pre">extensions</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_create_bind" title="Link to this definition">¶</a><br /></dt>
<dd><p>Create bind exec queue.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_device</span> <span class="pre">*xe</span></code></dt><dd><p>Xe device.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_tile</span> <span class="pre">*tile</span></code></dt><dd><p>tile which bind exec queue belongs to.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_vm</span> <span class="pre">*user_vm</span></code></dt><dd><p>The user VM which this exec queue belongs to</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u32</span> <span class="pre">flags</span></code></dt><dd><p>exec queue creation flags</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">u64</span> <span class="pre">extensions</span></code></dt><dd><p>exec queue creation extensions</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Normalize bind exec queue creation. Bind exec queue is tied to migration VM
for access to physical memory required for page table programming. On a
faulting devices the reserved copy engine instance must be used to avoid
deadlocking (user binds cannot get stuck behind faults as kernel binds which
resolve faults depend on user binds). On non-faulting devices any copy engine
can be used.</p>
<p>Returns exec queue on success, ERR_PTR on failure</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_lrc">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xe_lrc</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_lrc</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_lrc" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get the LRC from exec queue.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec_queue.</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Retrieves the primary LRC for the exec queue. Note that this function
returns only the first LRC instance, even when multiple parallel LRCs
are configured.</p>
<p><strong>Return</strong></p>
<p>Pointer to LRC on success, error on failure</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_is_lr">
<span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_is_lr</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_is_lr" title="Link to this definition">¶</a><br /></dt>
<dd><p>Whether an exec_queue is long-running</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec_queue</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>True if the exec_queue is long-running, false otherwise.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_is_idle">
<span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_is_idle</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_is_idle" title="Link to this definition">¶</a><br /></dt>
<dd><p>Whether an exec_queue is idle.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec_queue</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>FIXME: Need to determine what to use as the short-lived
timeline lock for the exec_queues, so that the return value
of this function becomes more than just an advisory
snapshot in time. The timeline lock must protect the
seqno from racing submissions on the same exec_queue.
Typically vm-&gt;resv, but user-created timeline locks use the migrate vm
and never grabs the migrate vm-&gt;resv so we have a race there.</p>
<p><strong>Return</strong></p>
<p>True if the exec_queue is idle, false otherwise.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_update_run_ticks">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_update_run_ticks</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_update_run_ticks" title="Link to this definition">¶</a><br /></dt>
<dd><p>Update run time in ticks for this exec queue from hw</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec queue</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Update the timestamp saved by HW for this exec queue and save run ticks
calculated by using the delta from last update.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_kill">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_kill</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_kill" title="Link to this definition">¶</a><br /></dt>
<dd><p>permanently stop all execution from an exec queue</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec queue</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>This function permanently stops all activity on an exec queue. If the queue
is actively executing on the HW, it will be kicked off the engine; any
pending jobs are discarded and all future submissions are rejected.
This function is safe to call multiple times.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_last_fence_put">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_last_fence_put</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xe_vm</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">vm</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_last_fence_put" title="Link to this definition">¶</a><br /></dt>
<dd><p>Drop ref to last fence</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_vm</span> <span class="pre">*vm</span></code></dt><dd><p>The VM the engine does a bind or exec for</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_last_fence_put_unlocked">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_last_fence_put_unlocked</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_last_fence_put_unlocked" title="Link to this definition">¶</a><br /></dt>
<dd><p>Drop ref to last fence unlocked</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec queue</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Only safe to be called from <code class="xref c c-func broken_xref docutils literal notranslate"><span class="pre">xe_exec_queue_destroy()</span></code>.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_last_fence_get">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../../driver-api/dma-buf.html#c.dma_fence" title="dma_fence"><span class="n"><span class="pre">dma_fence</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_last_fence_get</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xe_vm</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">vm</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_last_fence_get" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get last fence</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_vm</span> <span class="pre">*vm</span></code></dt><dd><p>The VM the engine does a bind or exec for</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Get last fence, takes a ref</p>
<p><strong>Return</strong></p>
<p>last fence if not signaled, dma fence stub if signaled</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_last_fence_get_for_resume">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../../driver-api/dma-buf.html#c.dma_fence" title="dma_fence"><span class="n"><span class="pre">dma_fence</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_last_fence_get_for_resume</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xe_vm</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">vm</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_last_fence_get_for_resume" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get last fence</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_vm</span> <span class="pre">*vm</span></code></dt><dd><p>The VM the engine does a bind or exec for</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Get last fence, takes a ref. Only safe to be called in the context of
resuming the hw engine group’s long-running exec queue, when the group
semaphore is held.</p>
<p><strong>Return</strong></p>
<p>last fence if not signaled, dma fence stub if signaled</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_last_fence_set">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_last_fence_set</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xe_vm</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">vm</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../../driver-api/dma-buf.html#c.dma_fence" title="dma_fence"><span class="n"><span class="pre">dma_fence</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fence</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_last_fence_set" title="Link to this definition">¶</a><br /></dt>
<dd><p>Set last fence</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_vm</span> <span class="pre">*vm</span></code></dt><dd><p>The VM the engine does a bind or exec for</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dma_fence</span> <span class="pre">*fence</span></code></dt><dd><p>The fence</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Set the last fence for the engine. Increases reference count for fence, when
closing engine xe_exec_queue_last_fence_put should be called.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_tlb_inval_last_fence_put">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_tlb_inval_last_fence_put</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xe_vm</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">vm</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_tlb_inval_last_fence_put" title="Link to this definition">¶</a><br /></dt>
<dd><p>Drop ref to last TLB invalidation fence</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_vm</span> <span class="pre">*vm</span></code></dt><dd><p>The VM the engine does a bind for</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">type</span></code></dt><dd><p>Either primary or media GT</p>
</dd>
</dl>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_tlb_inval_last_fence_put_unlocked">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_tlb_inval_last_fence_put_unlocked</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_tlb_inval_last_fence_put_unlocked" title="Link to this definition">¶</a><br /></dt>
<dd><p>Drop ref to last TLB invalidation fence unlocked</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">type</span></code></dt><dd><p>Either primary or media GT</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Only safe to be called from <code class="xref c c-func broken_xref docutils literal notranslate"><span class="pre">xe_exec_queue_destroy()</span></code>.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_tlb_inval_last_fence_get">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../../driver-api/dma-buf.html#c.dma_fence" title="dma_fence"><span class="n"><span class="pre">dma_fence</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_tlb_inval_last_fence_get</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xe_vm</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">vm</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_tlb_inval_last_fence_get" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get last fence for TLB invalidation</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_vm</span> <span class="pre">*vm</span></code></dt><dd><p>The VM the engine does a bind for</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">type</span></code></dt><dd><p>Either primary or media GT</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Get last fence, takes a ref</p>
<p><strong>Return</strong></p>
<p>last fence if not signaled, dma fence stub if signaled</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_tlb_inval_last_fence_set">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_tlb_inval_last_fence_set</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">xe_vm</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">vm</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../../driver-api/dma-buf.html#c.dma_fence" title="dma_fence"><span class="n"><span class="pre">dma_fence</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">fence</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">type</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_tlb_inval_last_fence_set" title="Link to this definition">¶</a><br /></dt>
<dd><p>Set last fence for TLB invalidation</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>The exec queue</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_vm</span> <span class="pre">*vm</span></code></dt><dd><p>The VM the engine does a bind for</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">dma_fence</span> <span class="pre">*fence</span></code></dt><dd><p>The fence</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">type</span></code></dt><dd><p>Either primary or media GT</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Set the last fence for the tlb invalidation type on the queue. Increases
reference count for fence, when closing queue
xe_exec_queue_tlb_inval_last_fence_put should be called.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_exec_queue_contexts_hwsp_rebase">
<span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_exec_queue_contexts_hwsp_rebase</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><span class="n"><span class="pre">xe_exec_queue</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">scratch</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_exec_queue_contexts_hwsp_rebase" title="Link to this definition">¶</a><br /></dt>
<dd><p>Re-compute GGTT references within all LRCs of a queue.</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">xe_exec_queue</span> <span class="pre">*q</span></code></dt><dd><p>the <a class="reference internal" href="#c.xe_exec_queue" title="xe_exec_queue"><code class="xref c c-type docutils literal notranslate"><span class="pre">xe_exec_queue</span></code></a> <code class="xref c c-struct broken_xref docutils literal notranslate"><span class="pre">struct</span> <span class="pre">instance</span></code> containing target LRCs</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*scratch</span></code></dt><dd><p>scratch buffer to be used as temporary storage</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>zero on success, negative error code on failure</p>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;The kernel development community.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/gpu/xe/xe_exec_queue.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
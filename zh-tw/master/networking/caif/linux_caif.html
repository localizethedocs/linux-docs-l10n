<!DOCTYPE html>

<html lang="zh-TW" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Linux CAIF &#8212; The Linux Kernel unknown version 說明文件</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=adfc0c0d" />
    <script src="../../_static/documentation_options.js?v=b446b479"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=cbf116e0"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/linux-docs-l10n/networking/caif/linux_caif.html" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜尋" href="../../search.html" />
    <link rel="next" title="Using Linux CAIF" href="caif.html" />
    <link rel="prev" title="CAIF" href="index.html" />

   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

<script type="text/javascript" src="../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../ltd-flyout.js"></script>

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.svg" alt="Logo of The Linux Kernel"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.19.0</p>







<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜尋</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="前往" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>


<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/submitting-patches.html">提交補釘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/code-of-conduct.html">行為守則</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">維護者手冊</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">All development-process docs</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">核心 API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">Driver APIs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../subsystem-apis.html">子系統</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../subsystem-apis.html#core-subsystems">Core subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../subsystem-apis.html#human-interfaces">Human interfaces</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../subsystem-apis.html#networking-interfaces">Networking interfaces</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">Networking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../isdn/index.html">ISDN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../mhi/index.html">MHI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../subsystem-apis.html#storage-interfaces">Storage interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../subsystem-apis.html#other-subsystems">其他子系統</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">撰寫文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">開發工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/testing-overview.html">測試指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../livepatch/index.html">即時補釘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rust/index.html">Rust</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kbuild/index.html">建置系統</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/reporting-issues.html">回報議題</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">使用者空間工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../userspace-api/index.html">使用者空間 API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">韌體</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicetree/index.html">韌體與裝置樹</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arch/index.html">CPU 架構</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html">未排序的文件</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>本頁</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/networking/caif/linux_caif.rst.txt"
            rel="nofollow">顯示原始碼</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="linux-caif">
<h1>Linux CAIF<a class="headerlink" href="#linux-caif" title="連結到這個標頭">¶</a></h1>
<p>Copyright © ST-Ericsson AB 2010</p>
<dl class="field-list simple">
<dt class="field-odd">作者<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sjur Brendeland/ <a class="reference external" href="mailto:sjur&#46;brandeland&#37;&#52;&#48;stericsson&#46;com">sjur<span>&#46;</span>brandeland<span>&#64;</span>stericsson<span>&#46;</span>com</a></p>
</dd>
<dt class="field-even">License terms<span class="colon">:</span></dt>
<dd class="field-even"><p>GNU General Public License (GPL) version 2</p>
</dd>
</dl>
<section id="introduction">
<h2>介紹<a class="headerlink" href="#introduction" title="連結到這個標頭">¶</a></h2>
<p>CAIF is a MUX protocol used by ST-Ericsson cellular modems for
communication between Modem and host. The host processes can open virtual AT
channels, initiate GPRS Data connections, Video channels and Utility Channels.
The Utility Channels are general purpose pipes between modem and host.</p>
<p>ST-Ericsson modems support a number of transports between modem
and host. Currently, UART and Loopback are available for Linux.</p>
</section>
<section id="architecture">
<h2>架構<a class="headerlink" href="#architecture" title="連結到這個標頭">¶</a></h2>
<p>The implementation of CAIF is divided into:</p>
<ul class="simple">
<li><p>CAIF Socket Layer and GPRS IP Interface.</p></li>
<li><p>CAIF Core Protocol Implementation</p></li>
<li><p>CAIF Link Layer, implemented as NET devices.</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>RTNL
 !
 !          +------+   +------+
 !         +------+!  +------+!
 !         !  IP  !!  !Socket!!
 +-------&gt; !interf!+  ! API  !+       &lt;- CAIF Client APIs
 !         +------+   +------!
 !            !           !
 !            +-----------+
 !                  !
 !               +------+             &lt;- CAIF Core Protocol
 !               ! CAIF !
 !               ! Core !
 !               +------+
 !       +----------!---------+
 !       !          !         !
 !    +------+   +-----+   +------+
 +--&gt; ! HSI  !   ! TTY !   ! USB  !   &lt;- Link Layer (Net Devices)
      +------+   +-----+   +------+
</pre></div>
</div>
</section>
<section id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="連結到這個標頭">¶</a></h2>
<section id="caif-core-protocol-layer">
<h3>CAIF Core Protocol Layer<a class="headerlink" href="#caif-core-protocol-layer" title="連結到這個標頭">¶</a></h3>
<p>CAIF Core layer implements the CAIF protocol as defined by ST-Ericsson.
It implements the CAIF protocol stack in a layered approach, where
each layer described in the specification is implemented as a separate layer.
The architecture is inspired by the design patterns &quot;Protocol Layer&quot; and
&quot;Protocol Packet&quot;.</p>
<section id="caif-structure">
<h4>CAIF structure<a class="headerlink" href="#caif-structure" title="連結到這個標頭">¶</a></h4>
<p>The Core CAIF implementation contains:</p>
<blockquote>
<div><ul class="simple">
<li><p>Simple implementation of CAIF.</p></li>
<li><p>Layered architecture (a la Streams), each layer in the CAIF
specification is implemented in a separate c-file.</p></li>
<li><p>Clients must call configuration function to add PHY layer.</p></li>
<li><p>Clients must implement CAIF layer to consume/produce
CAIF payload with receive and transmit functions.</p></li>
<li><p>Clients must call configuration function to add and connect the
Client layer.</p></li>
<li><p>When receiving / transmitting CAIF Packets (cfpkt), ownership is passed
to the called function (except for framing layers' receive function)</p></li>
</ul>
</div></blockquote>
</section>
</section>
</section>
<section id="layered-architecture">
<h2>Layered Architecture<a class="headerlink" href="#layered-architecture" title="連結到這個標頭">¶</a></h2>
<p>The CAIF protocol can be divided into two parts: Support functions and Protocol
Implementation. The support functions include:</p>
<blockquote>
<div><ul class="simple">
<li><p>CFPKT CAIF Packet. Implementation of CAIF Protocol Packet. The
CAIF Packet has functions for creating, destroying and adding content
and for adding/extracting header and trailers to protocol packets.</p></li>
</ul>
</div></blockquote>
<p>The CAIF Protocol implementation contains:</p>
<blockquote>
<div><ul class="simple">
<li><p>CFCNFG CAIF Configuration layer. Configures the CAIF Protocol
Stack and provides a Client interface for adding Link-Layer and
Driver interfaces on top of the CAIF Stack.</p></li>
<li><p>CFCTRL CAIF Control layer. Encodes and Decodes control messages
such as enumeration and channel setup. Also matches request and
response messages.</p></li>
<li><p>CFSERVL General CAIF Service Layer functionality; handles flow
control and remote shutdown requests.</p></li>
<li><p>CFVEI CAIF VEI layer. Handles CAIF AT Channels on VEI (Virtual
External Interface). This layer encodes/decodes VEI frames.</p></li>
<li><p>CFDGML CAIF Datagram layer. Handles CAIF Datagram layer (IP
traffic), encodes/decodes Datagram frames.</p></li>
<li><p>CFMUX CAIF Mux layer. Handles multiplexing between multiple
physical bearers and multiple channels such as VEI, Datagram, etc.
The MUX keeps track of the existing CAIF Channels and
Physical Instances and selects the appropriate instance based
on Channel-Id and Physical-ID.</p></li>
<li><p>CFFRML CAIF Framing layer. Handles Framing i.e. Frame length
and frame checksum.</p></li>
<li><p>CFSERL CAIF Serial layer. Handles concatenation/split of frames
into CAIF Frames with correct length.</p></li>
</ul>
</div></blockquote>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>                +---------+
                | Config  |
                | CFCNFG  |
                +---------+
                     !
+---------+     +---------+     +---------+
|   AT    |     | Control |     | Datagram|
| CFVEIL  |     | CFCTRL  |     | CFDGML  |
+---------+     +---------+     +---------+
       \_____________!______________/
                     !
                +---------+
                |   MUX   |
                |         |
                +---------+
                _____!_____
               /           \
        +---------+     +---------+
        | CFFRML  |     | CFFRML  |
        | Framing |     | Framing |
        +---------+     +---------+
             !              !
        +---------+     +---------+
        |         |     | Serial  |
        |         |     | CFSERL  |
        +---------+     +---------+
</pre></div>
</div>
<p>In this layered approach the following &quot;rules&quot; apply.</p>
<blockquote>
<div><ul>
<li><p>All layers embed the same structure &quot;<code class="xref c c-struct broken_xref docutils literal notranslate"><span class="pre">struct</span> <span class="pre">cflayer</span></code>&quot;</p></li>
<li><p>A layer does not depend on any other layer's private data.</p></li>
<li><p>Layers are stacked by setting the pointers:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>layer-&gt;up , layer-&gt;dn
</pre></div>
</div>
</li>
<li><p>In order to send data upwards, each layer should do:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>layer-&gt;up-&gt;receive(layer-&gt;up, packet);
</pre></div>
</div>
</li>
<li><p>In order to send data downwards, each layer should do:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>layer-&gt;dn-&gt;transmit(layer-&gt;dn, packet);
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
</section>
<section id="caif-socket-and-ip-interface">
<h2>CAIF Socket and IP interface<a class="headerlink" href="#caif-socket-and-ip-interface" title="連結到這個標頭">¶</a></h2>
<p>The IP interface and CAIF socket API are implemented on top of the
CAIF Core protocol. The IP Interface and CAIF socket have an instance of
'<code class="xref c c-struct broken_xref docutils literal notranslate"><span class="pre">struct</span> <span class="pre">cflayer</span></code>', just like the CAIF Core protocol stack.
Net device and Socket implement the '<code class="xref c c-func broken_xref docutils literal notranslate"><span class="pre">receive()</span></code>' function defined by
'<code class="xref c c-struct broken_xref docutils literal notranslate"><span class="pre">struct</span> <span class="pre">cflayer</span></code>', just like the rest of the CAIF stack. In this way, transmit and
receive of packets is handled as by the rest of the layers: the 'dn-&gt;<code class="xref c c-func broken_xref docutils literal notranslate"><span class="pre">transmit()</span></code>'
function is called in order to transmit data.</p>
<section id="configuration-of-link-layer">
<h3>Configuration of Link Layer<a class="headerlink" href="#configuration-of-link-layer" title="連結到這個標頭">¶</a></h3>
<p>The Link Layer is implemented as Linux network devices (<a class="reference internal" href="../kapi.html#c.net_device" title="net_device"><code class="xref c c-struct docutils literal notranslate"><span class="pre">struct</span> <span class="pre">net_device</span></code></a>).
Payload handling and registration is done using standard Linux mechanisms.</p>
<p>The CAIF Protocol relies on a loss-less link layer without implementing
retransmission. This implies that packet drops must not happen.
Therefore a flow-control mechanism is implemented where the physical
interface can initiate flow stop for all CAIF Channels.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;The kernel development community.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/networking/caif/linux_caif.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
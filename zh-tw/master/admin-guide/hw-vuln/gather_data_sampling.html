<!DOCTYPE html>

<html lang="zh-TW" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>GDS - Gather Data Sampling &#8212; The Linux Kernel  說明文件</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=adfc0c0d" />
    <script src="../../_static/documentation_options.js?v=0d9984b1"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=cbf116e0"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/linux-docs-l10n/admin-guide/hw-vuln/gather_data_sampling.html" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜尋" href="../../search.html" />
    <link rel="next" title="Register File Data Sampling (RFDS)" href="reg-file-data-sampling.html" />
    <link rel="prev" title="Speculative Return Stack Overflow (SRSO)" href="srso.html" />

   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

<script type="text/javascript" src="../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../ltd-flyout.js"></script>

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.svg" alt="Logo of The Linux Kernel"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.18.0-rc2</p>







<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜尋</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="前往" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>


<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/submitting-patches.html">提交補釘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/code-of-conduct.html">行為守則</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">維護者手冊</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">All development-process docs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">核心 API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">Driver APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../subsystem-apis.html">子系統</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">撰寫文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">開發工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/testing-overview.html">測試指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../livepatch/index.html">Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rust/index.html">Rust</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Administration</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#general-guides-to-kernel-administration">General guides to kernel administration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../README.html">Linux kernel release 6.x &lt;http://kernel.org/&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="../devices.html">Linux allocated devices (4.x+ version)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features.html">Feature status on all architectures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sysfs-rules.html">Rules on how to access information in sysfs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sysctl/index.html">Documentation for /proc/sys</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cputopology.html">How CPU topology info is exported via sysfs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abi.html">Linux ABI description</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Hardware vulnerabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../LSM/index.html">Linux Security Module Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../perf-security.html">Perf events and tool security</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#booting-the-kernel">Booting the kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#tracking-down-and-identifying-problems">Tracking down and identifying problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#core-kernel-subsystems">Core-kernel subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#block-layer-and-filesystem-administration">Block-layer and filesystem administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#device-specific-guides">Device-specific guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#workload-analysis">Workload analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#everything-else">Everything else</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../kbuild/index.html">建置系統</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reporting-issues.html">回報議題</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">使用者空間工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../userspace-api/index.html">使用者空間 API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">韌體</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicetree/index.html">韌體與裝置樹</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arch/index.html">CPU 架構</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html">未排序的文件</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>本頁</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/admin-guide/hw-vuln/gather_data_sampling.rst.txt"
            rel="nofollow">顯示原始碼</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="gds-gather-data-sampling">
<h1>GDS - Gather Data Sampling<a class="headerlink" href="#gds-gather-data-sampling" title="連結到這個標頭">¶</a></h1>
<p>Gather Data Sampling is a hardware vulnerability which allows unprivileged
speculative access to data which was previously stored in vector registers.</p>
<section id="problem">
<h2>Problem<a class="headerlink" href="#problem" title="連結到這個標頭">¶</a></h2>
<p>When a gather instruction performs loads from memory, different data elements
are merged into the destination vector register. However, when a gather
instruction that is transiently executed encounters a fault, stale data from
architectural or internal vector registers may get transiently forwarded to the
destination vector register instead. This will allow a malicious attacker to
infer stale data using typical side channel techniques like cache timing
attacks. GDS is a purely sampling-based attack.</p>
<p>The attacker uses gather instructions to infer the stale vector register data.
The victim does not need to do anything special other than use the vector
registers. The victim does not need to use gather instructions to be
vulnerable.</p>
<p>Because the buffers are shared between Hyper-Threads cross Hyper-Thread attacks
are possible.</p>
</section>
<section id="attack-scenarios">
<h2>Attack scenarios<a class="headerlink" href="#attack-scenarios" title="連結到這個標頭">¶</a></h2>
<p>Without mitigation, GDS can infer stale data across virtually all
permission boundaries:</p>
<blockquote>
<div><p>Non-enclaves can infer SGX enclave data
Userspace can infer kernel data
Guests can infer data from hosts
Guest can infer guest from other guests
Users can infer data from other users</p>
</div></blockquote>
<p>Because of this, it is important to ensure that the mitigation stays enabled in
lower-privilege contexts like guests and when running outside SGX enclaves.</p>
<p>The hardware enforces the mitigation for SGX. Likewise, VMMs should  ensure
that guests are not allowed to disable the GDS mitigation. If a host erred and
allowed this, a guest could theoretically disable GDS mitigation, mount an
attack, and re-enable it.</p>
</section>
<section id="mitigation-mechanism">
<h2>Mitigation mechanism<a class="headerlink" href="#mitigation-mechanism" title="連結到這個標頭">¶</a></h2>
<p>This issue is mitigated in microcode. The microcode defines the following new
bits:</p>
<blockquote>
<div><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>IA32_ARCH_CAPABILITIES[GDS_CTRL]</p></td>
<td><p>R/O</p></td>
<td><p>Enumerates GDS vulnerability
and mitigation support.</p></td>
</tr>
<tr class="row-even"><td><p>IA32_ARCH_CAPABILITIES[GDS_NO]</p></td>
<td><p>R/O</p></td>
<td><p>Processor is not vulnerable.</p></td>
</tr>
<tr class="row-odd"><td><p>IA32_MCU_OPT_CTRL[GDS_MITG_DIS]</p></td>
<td><p>R/W</p></td>
<td><p>Disables the mitigation
0 by default.</p></td>
</tr>
<tr class="row-even"><td><p>IA32_MCU_OPT_CTRL[GDS_MITG_LOCK]</p></td>
<td><p>R/W</p></td>
<td><p>Locks GDS_MITG_DIS=0. Writes
to GDS_MITG_DIS are ignored
Can't be cleared once set.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>GDS can also be mitigated on systems that don't have updated microcode by
disabling AVX. This can be done by setting gather_data_sampling=&quot;force&quot; or
&quot;clearcpuid=avx&quot; on the kernel command-line.</p>
<p>If used, these options will disable AVX use by turning off XSAVE YMM support.
However, the processor will still enumerate AVX support.  Userspace that
does not follow proper AVX enumeration to check both AVX <em>and</em> XSAVE YMM
support will break.</p>
</section>
<section id="mitigation-control-on-the-kernel-command-line">
<h2>Mitigation control on the kernel command line<a class="headerlink" href="#mitigation-control-on-the-kernel-command-line" title="連結到這個標頭">¶</a></h2>
<p>The mitigation can be disabled by setting &quot;gather_data_sampling=off&quot; or
&quot;mitigations=off&quot; on the kernel command line. Not specifying either will default
to the mitigation being enabled. Specifying &quot;gather_data_sampling=force&quot; will
use the microcode mitigation when available or disable AVX on affected systems
where the microcode hasn't been updated to include the mitigation.</p>
</section>
<section id="gds-system-information">
<h2>GDS System Information<a class="headerlink" href="#gds-system-information" title="連結到這個標頭">¶</a></h2>
<p>The kernel provides vulnerability status information through sysfs. For
GDS this can be accessed by the following sysfs file:</p>
<p>/sys/devices/system/cpu/vulnerabilities/gather_data_sampling</p>
<p>The possible values contained in this file are:</p>
<blockquote>
<div><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Not affected</p></td>
<td><p>Processor not vulnerable.</p></td>
</tr>
<tr class="row-even"><td><p>Vulnerable</p></td>
<td><p>Processor vulnerable and mitigation disabled.</p></td>
</tr>
<tr class="row-odd"><td><p>Vulnerable: No microcode</p></td>
<td><p>Processor vulnerable and microcode is missing
mitigation.</p></td>
</tr>
<tr class="row-even"><td><p>Mitigation: AVX disabled,</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>no microcode</p></td>
<td><p>Processor is vulnerable and microcode is missing
mitigation. AVX disabled as mitigation.</p></td>
</tr>
<tr class="row-even"><td><p>Mitigation: Microcode</p></td>
<td><p>Processor is vulnerable and mitigation is in
effect.</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation: Microcode (locked)</p></td>
<td><p>Processor is vulnerable and mitigation is in
effect and cannot be disabled.</p></td>
</tr>
<tr class="row-even"><td><p>Unknown: Dependent on</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>hypervisor status</p></td>
<td><p>Running on a virtual guest processor that is
affected but with no way to know if host
processor is mitigated or vulnerable.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="gds-default-mitigation">
<h2>GDS Default mitigation<a class="headerlink" href="#gds-default-mitigation" title="連結到這個標頭">¶</a></h2>
<p>The updated microcode will enable the mitigation by default. The kernel's
default action is to leave the mitigation enabled.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;The kernel development community.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/admin-guide/hw-vuln/gather_data_sampling.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
<!DOCTYPE html>

<html lang="zh-TW" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SRBDS - Special Register Buffer Data Sampling &#8212; The Linux Kernel unknown version 說明文件</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=adfc0c0d" />
    <script src="../../_static/documentation_options.js?v=b446b479"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=cbf116e0"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/linux-docs-l10n/admin-guide/hw-vuln/special-register-buffer-data-sampling.html" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜尋" href="../../search.html" />
    <link rel="next" title="Core Scheduling" href="core-scheduling.html" />
    <link rel="prev" title="iTLB multihit" href="multihit.html" />

   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

<script type="text/javascript" src="../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../ltd-flyout.js"></script>

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.svg" alt="Logo of The Linux Kernel"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.19.0</p>







<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜尋</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="前往" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>


<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/submitting-patches.html">提交補釘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/code-of-conduct.html">行為守則</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">維護者手冊</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">All development-process docs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">核心 API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">Driver APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../subsystem-apis.html">子系統</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">撰寫文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">開發工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/testing-overview.html">測試指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../livepatch/index.html">即時補釘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rust/index.html">Rust</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Administration</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#general-guides-to-kernel-administration">General guides to kernel administration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../README.html">Linux kernel release 6.x &lt;http://kernel.org/&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="../devices.html">Linux allocated devices (4.x+ version)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features.html">Feature status on all architectures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sysfs-rules.html">Rules on how to access information in sysfs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sysctl/index.html">Documentation for /proc/sys</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cputopology.html">How CPU topology info is exported via sysfs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abi.html">Linux ABI description</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Hardware vulnerabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../LSM/index.html">Linux Security Module Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../perf-security.html">Perf events and tool security</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#booting-the-kernel">Booting the kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#tracking-down-and-identifying-problems">Tracking down and identifying problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#core-kernel-subsystems">Core-kernel subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#block-layer-and-filesystem-administration">Block-layer and filesystem administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#device-specific-guides">Device-specific guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#workload-analysis">Workload analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#everything-else">Everything else</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../kbuild/index.html">建置系統</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reporting-issues.html">回報議題</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">使用者空間工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../userspace-api/index.html">使用者空間 API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">韌體</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicetree/index.html">韌體與裝置樹</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arch/index.html">CPU 架構</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html">未排序的文件</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>本頁</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/admin-guide/hw-vuln/special-register-buffer-data-sampling.rst.txt"
            rel="nofollow">顯示原始碼</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="srbds-special-register-buffer-data-sampling">
<h1>SRBDS - Special Register Buffer Data Sampling<a class="headerlink" href="#srbds-special-register-buffer-data-sampling" title="連結到這個標頭">¶</a></h1>
<p>SRBDS is a hardware vulnerability that allows MDS
<a class="reference internal" href="mds.html"><span class="doc">MDS - Microarchitectural Data Sampling</span></a> techniques to
infer values returned from special register accesses.  Special register
accesses are accesses to off core registers.  According to Intel's evaluation,
the special register reads that have a security expectation of privacy are
RDRAND, RDSEED and SGX EGETKEY.</p>
<p>When RDRAND, RDSEED and EGETKEY instructions are used, the data is moved
to the core through the special register mechanism that is susceptible
to MDS attacks.</p>
<section id="affected-processors">
<h2>Affected processors<a class="headerlink" href="#affected-processors" title="連結到這個標頭">¶</a></h2>
<p>Core models (desktop, mobile, Xeon-E3) that implement RDRAND and/or RDSEED may
be affected.</p>
<p>A processor is affected by SRBDS if its Family_Model and stepping is
in the following list, with the exception of the listed processors
exporting MDS_NO while Intel TSX is available yet not enabled. The
latter class of processors are only affected when Intel TSX is enabled
by software using TSX_CTRL_MSR otherwise they are not affected.</p>
<blockquote>
<div><table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>common name</p></th>
<th class="head"><p>Family_Model</p></th>
<th class="head"><p>Stepping</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>IvyBridge</p></td>
<td><p>06_3AH</p></td>
<td><p>All</p></td>
</tr>
<tr class="row-odd"><td><p>Haswell</p></td>
<td><p>06_3CH</p></td>
<td><p>All</p></td>
</tr>
<tr class="row-even"><td><p>Haswell_L</p></td>
<td><p>06_45H</p></td>
<td><p>All</p></td>
</tr>
<tr class="row-odd"><td><p>Haswell_G</p></td>
<td><p>06_46H</p></td>
<td><p>All</p></td>
</tr>
<tr class="row-even"><td><p>Broadwell_G</p></td>
<td><p>06_47H</p></td>
<td><p>All</p></td>
</tr>
<tr class="row-odd"><td><p>Broadwell</p></td>
<td><p>06_3DH</p></td>
<td><p>All</p></td>
</tr>
<tr class="row-even"><td><p>Skylake_L</p></td>
<td><p>06_4EH</p></td>
<td><p>All</p></td>
</tr>
<tr class="row-odd"><td><p>Skylake</p></td>
<td><p>06_5EH</p></td>
<td><p>All</p></td>
</tr>
<tr class="row-even"><td><p>Kabylake_L</p></td>
<td><p>06_8EH</p></td>
<td><p>&lt;= 0xC</p></td>
</tr>
<tr class="row-odd"><td><p>Kabylake</p></td>
<td><p>06_9EH</p></td>
<td><p>&lt;= 0xD</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="related-cves">
<h2>Related CVEs<a class="headerlink" href="#related-cves" title="連結到這個標頭">¶</a></h2>
<p>The following CVE entry is related to this SRBDS issue:</p>
<blockquote>
<div><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>CVE-2020-0543</p></td>
<td><p>SRBDS</p></td>
<td><p>Special Register Buffer Data Sampling</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="attack-scenarios">
<h2>Attack scenarios<a class="headerlink" href="#attack-scenarios" title="連結到這個標頭">¶</a></h2>
<p>An unprivileged user can extract values returned from RDRAND and RDSEED
executed on another core or sibling thread using MDS techniques.</p>
</section>
<section id="mitigation-mechanism">
<h2>Mitigation mechanism<a class="headerlink" href="#mitigation-mechanism" title="連結到這個標頭">¶</a></h2>
<p>Intel will release microcode updates that modify the RDRAND, RDSEED, and
EGETKEY instructions to overwrite secret special register data in the shared
staging buffer before the secret data can be accessed by another logical
processor.</p>
<p>During execution of the RDRAND, RDSEED, or EGETKEY instructions, off-core
accesses from other logical processors will be delayed until the special
register read is complete and the secret data in the shared staging buffer is
overwritten.</p>
<p>This has three effects on performance:</p>
<ol class="arabic simple">
<li><p>RDRAND, RDSEED, or EGETKEY instructions have higher latency.</p></li>
<li><p>Executing RDRAND at the same time on multiple logical processors will be
serialized, resulting in an overall reduction in the maximum RDRAND
bandwidth.</p></li>
<li><p>Executing RDRAND, RDSEED or EGETKEY will delay memory accesses from other
logical processors that miss their core caches, with an impact similar to
legacy locked cache-line-split accesses.</p></li>
</ol>
<p>The microcode updates provide an opt-out mechanism (RNGDS_MITG_DIS) to disable
the mitigation for RDRAND and RDSEED instructions executed outside of Intel
Software Guard Extensions (Intel SGX) enclaves. On logical processors that
disable the mitigation using this opt-out mechanism, RDRAND and RDSEED do not
take longer to execute and do not impact performance of sibling logical
processors memory accesses. The opt-out mechanism does not affect Intel SGX
enclaves (including execution of RDRAND or RDSEED inside an enclave, as well
as EGETKEY execution).</p>
</section>
<section id="ia32-mcu-opt-ctrl-msr-definition">
<h2>IA32_MCU_OPT_CTRL MSR Definition<a class="headerlink" href="#ia32-mcu-opt-ctrl-msr-definition" title="連結到這個標頭">¶</a></h2>
<p>Along with the mitigation for this issue, Intel added a new thread-scope
IA32_MCU_OPT_CTRL MSR, (address 0x123). The presence of this MSR and
RNGDS_MITG_DIS (bit 0) is enumerated by CPUID.(EAX=07H,ECX=0).EDX[SRBDS_CTRL =
9]==1. This MSR is introduced through the microcode update.</p>
<p>Setting IA32_MCU_OPT_CTRL[0] (RNGDS_MITG_DIS) to 1 for a logical processor
disables the mitigation for RDRAND and RDSEED executed outside of an Intel SGX
enclave on that logical processor. Opting out of the mitigation for a
particular logical processor does not affect the RDRAND and RDSEED mitigations
for other logical processors.</p>
<p>Note that inside of an Intel SGX enclave, the mitigation is applied regardless
of the value of RNGDS_MITG_DS.</p>
</section>
<section id="mitigation-control-on-the-kernel-command-line">
<h2>Mitigation control on the kernel command line<a class="headerlink" href="#mitigation-control-on-the-kernel-command-line" title="連結到這個標頭">¶</a></h2>
<p>The kernel command line allows control over the SRBDS mitigation at boot time
with the option &quot;srbds=&quot;.  The option for this is:</p>
<blockquote>
<div><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>off</p></td>
<td><p>This option disables SRBDS mitigation for RDRAND and RDSEED on
affected platforms.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="srbds-system-information">
<h2>SRBDS System Information<a class="headerlink" href="#srbds-system-information" title="連結到這個標頭">¶</a></h2>
<p>The Linux kernel provides vulnerability status information through sysfs.  For
SRBDS this can be accessed by the following sysfs file:
/sys/devices/system/cpu/vulnerabilities/srbds</p>
<p>The possible values contained in this file are:</p>
<blockquote>
<div><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Not affected</p></td>
<td><p>Processor not vulnerable</p></td>
</tr>
<tr class="row-even"><td><p>Vulnerable</p></td>
<td><p>Processor vulnerable and mitigation disabled</p></td>
</tr>
<tr class="row-odd"><td><p>Vulnerable: No microcode</p></td>
<td><p>Processor vulnerable and microcode is missing
mitigation</p></td>
</tr>
<tr class="row-even"><td><p>Mitigation: Microcode</p></td>
<td><p>Processor is vulnerable and mitigation is in
effect.</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation: TSX disabled</p></td>
<td><p>Processor is only vulnerable when TSX is
enabled while this system was booted with TSX
disabled.</p></td>
</tr>
<tr class="row-even"><td><p>Unknown: Dependent on</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>hypervisor status</p></td>
<td><p>Running on virtual guest processor that is
affected but with no way to know if host
processor is mitigated or vulnerable.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</section>
<section id="srbds-default-mitigation">
<h2>SRBDS Default mitigation<a class="headerlink" href="#srbds-default-mitigation" title="連結到這個標頭">¶</a></h2>
<p>This new microcode serializes processor access during execution of RDRAND,
RDSEED ensures that the shared buffer is overwritten before it is released for
reuse.  Use the &quot;srbds=off&quot; kernel command line to disable the mitigation for
RDRAND and RDSEED.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;The kernel development community.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/admin-guide/hw-vuln/special-register-buffer-data-sampling.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
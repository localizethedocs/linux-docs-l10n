<!DOCTYPE html>

<html lang="zh-TW" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Kernel driver bh1770glc &#8212; The Linux Kernel  說明文件</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=adfc0c0d" />
    <script src="../_static/documentation_options.js?v=0d9984b1"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=cbf116e0"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/linux-docs-l10n/misc-devices/bh1770glc.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜尋" href="../search.html" />
    <link rel="next" title="C2 port support" href="c2port.html" />
    <link rel="prev" title="Kernel driver apds990x" href="apds990x.html" />

   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

<script type="text/javascript" src="../ltd-provenance.js"></script>
<script type="text/javascript" src="../ltd-current.js"></script>
<script type="text/javascript" src="../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../ltd-flyout.js"></script>

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.svg" alt="Logo of The Linux Kernel"/>
            </a></p>
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.18.0-rc2</p>







<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜尋</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="前往" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>


<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/submitting-patches.html">提交補釘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/code-of-conduct.html">行為守則</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">維護者手冊</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">All development-process docs</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">核心 API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">Driver APIs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../subsystem-apis.html">子系統</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#core-subsystems">Core subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#human-interfaces">Human interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#networking-interfaces">Networking interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#storage-interfaces">Storage interfaces</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../subsystem-apis.html#other-subsystems">Other subsystems</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../accounting/index.html">Accounting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpu-freq/index.html">CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../edac/index.html">EDAC 子系統</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fpga/index.html">FPGA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pcmcia/index.html">PCMCIA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../watchdog/index.html">Watchdog Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../virt/index.html">Virtualization Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hwmon/index.html">Hardware Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../accel/index.html">Compute Accelerators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../crypto/index.html">Crypto API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bpf/index.html">BPF 文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../usb/index.html">USB support</a></li>
<li class="toctree-l3"><a class="reference internal" href="../PCI/index.html">PCI Bus Subsystem</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../peci/index.html">PECI 子系統</a></li>
<li class="toctree-l3"><a class="reference internal" href="../wmi/index.html">WMI Subsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tee/index.html">TEE Subsystem</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">撰寫文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">開發工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/testing-overview.html">測試指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rust/index.html">Rust</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">建置系統</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/reporting-issues.html">回報議題</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">使用者空間工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">使用者空間 API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">韌體</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devicetree/index.html">韌體與裝置樹</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arch/index.html">CPU 架構</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html">未排序的文件</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>本頁</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/misc-devices/bh1770glc.rst.txt"
            rel="nofollow">顯示原始碼</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="kernel-driver-bh1770glc">
<h1>Kernel driver bh1770glc<a class="headerlink" href="#kernel-driver-bh1770glc" title="連結到這個標頭">¶</a></h1>
<p>Supported chips:</p>
<ul class="simple">
<li><p>ROHM BH1770GLC</p></li>
<li><p>OSRAM SFH7770</p></li>
</ul>
<p>Data sheet:
Not freely available</p>
<p>Author:
Samu Onkalo &lt;<a class="reference external" href="mailto:samu&#46;p&#46;onkalo&#37;&#52;&#48;nokia&#46;com">samu<span>&#46;</span>p<span>&#46;</span>onkalo<span>&#64;</span>nokia<span>&#46;</span>com</a>&gt;</p>
<section id="description">
<h2>描述<a class="headerlink" href="#description" title="連結到這個標頭">¶</a></h2>
<p>BH1770GLC and SFH7770 are combined ambient light and proximity sensors.
ALS and proximity parts operates on their own, but they shares common I2C
interface and interrupt logic. In principle they can run on their own,
but ALS side results are used to estimate reliability of the proximity sensor.</p>
<p>ALS produces 16 bit lux values. The chip contains interrupt logic to produce
low and high threshold interrupts.</p>
<p>Proximity part contains IR-led driver up to 3 IR leds. The chip measures
amount of reflected IR light and produces proximity result. Resolution is
8 bit. Driver supports only one channel. Driver uses ALS results to estimate
reliability of the proximity results. Thus ALS is always running while
proximity detection is needed.</p>
<p>Driver uses threshold interrupts to avoid need for polling the values.
Proximity low interrupt doesn't exists in the chip. This is simulated
by using a delayed work. As long as there is proximity threshold above
interrupts the delayed work is pushed forward. So, when proximity level goes
below the threshold value, there is no interrupt and the delayed work will
finally run. This is handled as no proximity indication.</p>
<p>Chip state is controlled via runtime pm framework when enabled in config.</p>
<p>Calibscale factor is used to hide differences between the chips. By default
value set to neutral state meaning factor of 1.00. To get proper values,
calibrated source of light is needed as a reference. Calibscale factor is set
so that measurement produces about the expected lux value.</p>
</section>
<section id="sysfs">
<h2>SYSFS<a class="headerlink" href="#sysfs" title="連結到這個標頭">¶</a></h2>
<dl>
<dt>chip_id</dt><dd><p>RO - shows detected chip type and version</p>
</dd>
<dt>power_state</dt><dd><p>RW - enable / disable chip</p>
<p>Uses counting logic</p>
<blockquote>
<div><ul class="simple">
<li><p>1 enables the chip</p></li>
<li><p>0 disables the chip</p></li>
</ul>
</div></blockquote>
</dd>
<dt>lux0_input</dt><dd><p>RO - measured lux value</p>
<blockquote>
<div><p>sysfs_notify called when threshold interrupt occurs</p>
</div></blockquote>
</dd>
<dt>lux0_sensor_range</dt><dd><p>RO - lux0_input max value</p>
</dd>
<dt>lux0_rate</dt><dd><p>RW - measurement rate in Hz</p>
</dd>
<dt>lux0_rate_avail</dt><dd><p>RO - supported measurement rates</p>
</dd>
<dt>lux0_thresh_above_value</dt><dd><p>RW - HI level threshold value</p>
<blockquote>
<div><p>All results above the value
trigs an interrupt. 65535 (i.e. sensor_range) disables the above
interrupt.</p>
</div></blockquote>
</dd>
<dt>lux0_thresh_below_value</dt><dd><p>RW - LO level threshold value</p>
<blockquote>
<div><p>All results below the value
trigs an interrupt. 0 disables the below interrupt.</p>
</div></blockquote>
</dd>
<dt>lux0_calibscale</dt><dd><p>RW - calibration value</p>
<blockquote>
<div><p>Set to neutral value by default.
Output results are multiplied with calibscale / calibscale_default
value.</p>
</div></blockquote>
</dd>
<dt>lux0_calibscale_default</dt><dd><p>RO - neutral calibration value</p>
</dd>
<dt>prox0_raw</dt><dd><p>RO - measured proximity value</p>
<blockquote>
<div><p>sysfs_notify called when threshold interrupt occurs</p>
</div></blockquote>
</dd>
<dt>prox0_sensor_range</dt><dd><p>RO - prox0_raw max value</p>
</dd>
<dt>prox0_raw_en</dt><dd><p>RW - enable / disable proximity</p>
<blockquote>
<div><p>Uses counting logic</p>
<ul class="simple">
<li><p>1 enables the proximity</p></li>
<li><p>0 disables the proximity</p></li>
</ul>
</div></blockquote>
</dd>
<dt>prox0_thresh_above_count</dt><dd><p>RW - number of proximity interrupts needed before triggering the event</p>
</dd>
<dt>prox0_rate_above</dt><dd><p>RW - Measurement rate (in Hz) when the level is above threshold
i.e. when proximity on has been reported.</p>
</dd>
<dt>prox0_rate_below</dt><dd><p>RW - Measurement rate (in Hz) when the level is below threshold
i.e. when proximity off has been reported.</p>
</dd>
<dt>prox0_rate_avail</dt><dd><p>RO - Supported proximity measurement rates in Hz</p>
</dd>
<dt>prox0_thresh_above0_value</dt><dd><p>RW - threshold level which trigs proximity events.</p>
<blockquote>
<div><p>Filtered by persistence filter (prox0_thresh_above_count)</p>
</div></blockquote>
</dd>
<dt>prox0_thresh_above1_value</dt><dd><p>RW - threshold level which trigs event immediately</p>
</dd>
</dl>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;The kernel development community.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/misc-devices/bh1770glc.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
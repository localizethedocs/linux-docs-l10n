<!DOCTYPE html>

<html lang="zh-TW" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ktime accessors &#8212; The Linux Kernel  說明文件</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=adfc0c0d" />
    <script src="../_static/documentation_options.js?v=0d9984b1"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=cbf116e0"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/linux-docs-l10n/core-api/timekeeping.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜尋" href="../search.html" />
    <link rel="next" title="The errseq_t datatype" href="errseq.html" />
    <link rel="prev" title="this_cpu operations" href="this_cpu_ops.html" />

   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

<script type="text/javascript" src="../ltd-provenance.js"></script>
<script type="text/javascript" src="../ltd-current.js"></script>
<script type="text/javascript" src="../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../ltd-flyout.js"></script>

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.svg" alt="Logo of The Linux Kernel"/>
            </a></p>
<h1 class="logo"><a href="../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.18.0-rc2</p>







<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜尋</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="前往" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>


<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/submitting-patches.html">提交補釘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/code-of-conduct.html">行為守則</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">維護者手冊</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">All development-process docs</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">核心 API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#core-utilities">Core utilities</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#data-structures-and-low-level-utilities">Data structures and low-level utilities</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="kobject.html">Everything you never wanted to know about kobjects, ksets, and ktypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="kref.html">Adding reference counters (krefs) to kernel objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="cleanup.html">Scope-based Cleanup Helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="assoc_array.html">Generic Associative Array Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="folio_queue.html">Folio Queue</a></li>
<li class="toctree-l3"><a class="reference internal" href="xarray.html">XArray</a></li>
<li class="toctree-l3"><a class="reference internal" href="maple_tree.html">Maple Tree</a></li>
<li class="toctree-l3"><a class="reference internal" href="idr.html">ID Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="circular-buffers.html">Circular Buffers</a></li>
<li class="toctree-l3"><a class="reference internal" href="rbtree.html">Red-black Trees (rbtree) in Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="generic-radix-tree.html">Generic radix trees/sparse arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="packing.html">Generic bitfield packing and unpacking functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="this_cpu_ops.html">this_cpu operations</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">ktime accessors</a></li>
<li class="toctree-l3"><a class="reference internal" href="errseq.html">The errseq_t datatype</a></li>
<li class="toctree-l3"><a class="reference internal" href="wrappers/atomic_t.html">Atomic types</a></li>
<li class="toctree-l3"><a class="reference internal" href="wrappers/atomic_bitops.html">Atomic bitops</a></li>
<li class="toctree-l3"><a class="reference internal" href="floating-point.html">Floating-point API</a></li>
<li class="toctree-l3"><a class="reference internal" href="union_find.html">Union-Find in Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="min_heap.html">Min Heap API</a></li>
<li class="toctree-l3"><a class="reference internal" href="parser.html">Generic parser</a></li>
<li class="toctree-l3"><a class="reference internal" href="list.html">Linked Lists in Linux</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#low-level-entry-and-exit">Low level entry and exit</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#concurrency-primitives">Concurrency primitives</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#low-level-hardware-management">Low-level hardware management</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#memory-management">Memory management</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#interfaces-for-kernel-debugging">Interfaces for kernel debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#everything-else">Everything else</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">Driver APIs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../subsystem-apis.html">子系統</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../subsystem-apis.html#core-subsystems">Core subsystems</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">核心 API 文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../driver-api/index.html">Driver implementer's API guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mm/index.html">記憶體管理文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../power/index.html">電源管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../scheduler/index.html">Scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../timers/index.html">計時器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../locking/index.html">Locking</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#human-interfaces">Human interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#networking-interfaces">Networking interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#storage-interfaces">Storage interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../subsystem-apis.html#other-subsystems">Other subsystems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">撰寫文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">開發工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/testing-overview.html">測試指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rust/index.html">Rust</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">建置系統</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/reporting-issues.html">回報議題</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">使用者空間工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">使用者空間 API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">韌體</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devicetree/index.html">韌體與裝置樹</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arch/index.html">CPU 架構</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html">未排序的文件</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>本頁</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/core-api/timekeeping.rst.txt"
            rel="nofollow">顯示原始碼</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="ktime-accessors">
<h1>ktime accessors<a class="headerlink" href="#ktime-accessors" title="連結到這個標頭">¶</a></h1>
<p>Device drivers can read the current time using <a class="reference internal" href="#c.ktime_get" title="ktime_get"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get()</span></code></a> and the many
related functions declared in linux/timekeeping.h. As a rule of thumb,
using an accessor with a shorter name is preferred over one with a longer
name if both are equally fit for a particular use case.</p>
<section id="basic-ktime-t-based-interfaces">
<h2>Basic ktime_t based interfaces<a class="headerlink" href="#basic-ktime-t-based-interfaces" title="連結到這個標頭">¶</a></h2>
<p>The recommended simplest form returns an opaque ktime_t, with variants
that return time for different clock references:</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.ktime_get">
<span class="n"><span class="pre">ktime_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get" title="連結到這個定義">¶</a><br /></dt>
<dd><p>CLOCK_MONOTONIC</p>
<p>Useful for reliable timestamps and measuring short time intervals
accurately. Starts at system boot time but stops during suspend.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.ktime_get_boottime">
<span class="n"><span class="pre">ktime_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_boottime</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_boottime" title="連結到這個定義">¶</a><br /></dt>
<dd><p>CLOCK_BOOTTIME</p>
<p>Like <a class="reference internal" href="#c.ktime_get" title="ktime_get"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get()</span></code></a>, but does not stop when suspended. This can be
used e.g. for key expiration times that need to be synchronized
with other machines across a suspend operation.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.ktime_get_real">
<span class="n"><span class="pre">ktime_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_real</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_real" title="連結到這個定義">¶</a><br /></dt>
<dd><p>CLOCK_REALTIME</p>
<p>Returns the time in relative to the UNIX epoch starting in 1970
using the Coordinated Universal Time (UTC), same as <code class="xref c c-func broken_xref docutils literal notranslate"><span class="pre">gettimeofday()</span></code>
user space. This is used for all timestamps that need to
persist across a reboot, like inode times, but should be avoided
for internal uses, since it can jump backwards due to a leap
second update, NTP adjustment <code class="xref c c-func broken_xref docutils literal notranslate"><span class="pre">settimeofday()</span></code> operation from user
space.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.ktime_get_clocktai">
<span class="n"><span class="pre">ktime_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_clocktai</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_clocktai" title="連結到這個定義">¶</a><br /></dt>
<dd><blockquote>
<div><p>CLOCK_TAI</p>
</div></blockquote>
<p>Like <a class="reference internal" href="#c.ktime_get_real" title="ktime_get_real"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_real()</span></code></a>, but uses the International Atomic Time (TAI)
reference instead of UTC to avoid jumping on leap second updates.
This is rarely useful in the kernel.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.ktime_get_raw">
<span class="n"><span class="pre">ktime_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_raw</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_raw" title="連結到這個定義">¶</a><br /></dt>
<dd><p>CLOCK_MONOTONIC_RAW</p>
<p>Like <a class="reference internal" href="#c.ktime_get" title="ktime_get"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get()</span></code></a>, but runs at the same rate as the hardware
clocksource without (NTP) adjustments for clock drift. This is
also rarely needed in the kernel.</p>
</dd></dl>

</section>
<section id="nanosecond-timespec64-and-second-output">
<h2>nanosecond, timespec64, and second output<a class="headerlink" href="#nanosecond-timespec64-and-second-output" title="連結到這個標頭">¶</a></h2>
<p>For all of the above, there are variants that return the time in a
different format depending on what is required by the user:</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.ktime_get_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_ns" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_boottime_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_boottime_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_boottime_ns" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_real_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_real_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_real_ns" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_clocktai_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_clocktai_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_clocktai_ns" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_raw_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_raw_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_raw_ns" title="連結到這個定義">¶</a><br /></dt>
<dd><p>Same as the plain ktime_get functions, but returning a u64 number
of nanoseconds in the respective time reference, which may be
more convenient for some callers.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.ktime_get_ts64">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_ts64</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_ts64" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_boottime_ts64">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_boottime_ts64</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_boottime_ts64" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_real_ts64">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_real_ts64</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_real_ts64" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_clocktai_ts64">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_clocktai_ts64</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_clocktai_ts64" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_raw_ts64">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_raw_ts64</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_raw_ts64" title="連結到這個定義">¶</a><br /></dt>
<dd><p>Same above, but returns the time in a '<code class="xref c c-struct broken_xref docutils literal notranslate"><span class="pre">struct</span> <span class="pre">timespec64</span></code>', split
into seconds and nanoseconds. This can avoid an extra division
when printing the time, or when passing it into an external
interface that expects a 'timespec' or 'timeval' structure.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.ktime_get_seconds">
<span class="n"><span class="pre">time64_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_seconds</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_seconds" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_boottime_seconds">
<span class="n"><span class="pre">time64_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_boottime_seconds</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_boottime_seconds" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_real_seconds">
<span class="n"><span class="pre">time64_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_real_seconds</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_real_seconds" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_clocktai_seconds">
<span class="n"><span class="pre">time64_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_clocktai_seconds</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_clocktai_seconds" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_raw_seconds">
<span class="n"><span class="pre">time64_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_raw_seconds</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_raw_seconds" title="連結到這個定義">¶</a><br /></dt>
<dd><p>Return a coarse-grained version of the time as a scalar
time64_t. This avoids accessing the clock hardware and rounds
down the seconds to the full seconds of the last timer tick
using the respective reference.</p>
</dd></dl>

</section>
<section id="coarse-and-fast-ns-access">
<h2>Coarse and fast_ns access<a class="headerlink" href="#coarse-and-fast-ns-access" title="連結到這個標頭">¶</a></h2>
<p>Some additional variants exist for more specialized cases:</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.ktime_get_coarse">
<span class="n"><span class="pre">ktime_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_coarse</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_coarse" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_coarse_boottime">
<span class="n"><span class="pre">ktime_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_coarse_boottime</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_coarse_boottime" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_coarse_real">
<span class="n"><span class="pre">ktime_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_coarse_real</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_coarse_real" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_coarse_clocktai">
<span class="n"><span class="pre">ktime_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_coarse_clocktai</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_coarse_clocktai" title="連結到這個定義">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.ktime_get_coarse_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_coarse_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_coarse_ns" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_coarse_boottime_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_coarse_boottime_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_coarse_boottime_ns" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_coarse_real_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_coarse_real_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_coarse_real_ns" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_coarse_clocktai_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_coarse_clocktai_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_coarse_clocktai_ns" title="連結到這個定義">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.ktime_get_coarse_ts64">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_coarse_ts64</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_coarse_ts64" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_coarse_boottime_ts64">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_coarse_boottime_ts64</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_coarse_boottime_ts64" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_coarse_real_ts64">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_coarse_real_ts64</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_coarse_real_ts64" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_coarse_clocktai_ts64">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_coarse_clocktai_ts64</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_coarse_clocktai_ts64" title="連結到這個定義">¶</a><br /></dt>
<dd><p>These are quicker than the non-coarse versions, but less accurate,
corresponding to CLOCK_MONOTONIC_COARSE and CLOCK_REALTIME_COARSE
in user space, along with the equivalent boottime/tai/raw
timebase not available in user space.</p>
<p>The time returned here corresponds to the last timer tick, which
may be as much as 10ms in the past (for CONFIG_HZ=100), same as
reading the 'jiffies' variable.  These are only useful when called
in a fast path and one still expects better than second accuracy,
but can't easily use 'jiffies', e.g. for inode timestamps.
Skipping the hardware clock access saves around 100 CPU cycles
on most modern machines with a reliable cycle counter, but
up to several microseconds on older hardware with an external
clocksource.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.ktime_get_mono_fast_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_mono_fast_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_mono_fast_ns" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_raw_fast_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_raw_fast_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_raw_fast_ns" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_boot_fast_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_boot_fast_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_boot_fast_ns" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_tai_fast_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_tai_fast_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_tai_fast_ns" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_real_fast_ns">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_real_fast_ns</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_real_fast_ns" title="連結到這個定義">¶</a><br /></dt>
<dd><p>These variants are safe to call from any context, including from
a non-maskable interrupt (NMI) during a timekeeper update, and
while we are entering suspend with the clocksource powered down.
This is useful in some tracing or debugging code as well as
machine check reporting, but most drivers should never call them,
since the time is allowed to jump under certain conditions.</p>
</dd></dl>

</section>
<section id="deprecated-time-interfaces">
<h2>Deprecated time interfaces<a class="headerlink" href="#deprecated-time-interfaces" title="連結到這個標頭">¶</a></h2>
<p>Older kernels used some other interfaces that are now being phased out
but may appear in third-party drivers being ported here. In particular,
all interfaces returning a '<code class="xref c c-struct broken_xref docutils literal notranslate"><span class="pre">struct</span> <span class="pre">timeval</span></code>' or '<code class="xref c c-struct broken_xref docutils literal notranslate"><span class="pre">struct</span> <span class="pre">timespec</span></code>' have
been replaced because the tv_sec member overflows in year 2038 on 32-bit
architectures. These are the recommended replacements:</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.ktime_get_ts">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_ts</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_ts" title="連結到這個定義">¶</a><br /></dt>
<dd><p>Use <a class="reference internal" href="#c.ktime_get" title="ktime_get"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get()</span></code></a> or <a class="reference internal" href="#c.ktime_get_ts64" title="ktime_get_ts64"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_ts64()</span></code></a> instead.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.do_gettimeofday">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">do_gettimeofday</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timeval</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.do_gettimeofday" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.getnstimeofday">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">getnstimeofday</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.getnstimeofday" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.getnstimeofday64">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">getnstimeofday64</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.getnstimeofday64" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.ktime_get_real_ts">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ktime_get_real_ts</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec</span></span><span class="p"><span class="pre">*</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.ktime_get_real_ts" title="連結到這個定義">¶</a><br /></dt>
<dd><p><a class="reference internal" href="#c.ktime_get_real_ts64" title="ktime_get_real_ts64"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_real_ts64()</span></code></a> is a direct replacement, but consider using
monotonic time (<a class="reference internal" href="#c.ktime_get_ts64" title="ktime_get_ts64"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_ts64()</span></code></a>) and/or a ktime_t based interface
(<a class="reference internal" href="#c.ktime_get" title="ktime_get"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get()</span></code></a>/<a class="reference internal" href="#c.ktime_get_real" title="ktime_get_real"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_real()</span></code></a>).</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.current_kernel_time">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">current_kernel_time</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.current_kernel_time" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.current_kernel_time64">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">current_kernel_time64</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.current_kernel_time64" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.get_monotonic_coarse">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_monotonic_coarse</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.get_monotonic_coarse" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.get_monotonic_coarse64">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_monotonic_coarse64</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.get_monotonic_coarse64" title="連結到這個定義">¶</a><br /></dt>
<dd><p>These are replaced by <a class="reference internal" href="#c.ktime_get_coarse_real_ts64" title="ktime_get_coarse_real_ts64"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_coarse_real_ts64()</span></code></a> and
<a class="reference internal" href="#c.ktime_get_coarse_ts64" title="ktime_get_coarse_ts64"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_coarse_ts64()</span></code></a>. However, A lot of code that wants
coarse-grained times can use the simple 'jiffies' instead, while
some drivers may actually want the higher resolution accessors
these days.</p>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.getrawmonotonic">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">getrawmonotonic</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.getrawmonotonic" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.getrawmonotonic64">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">getrawmonotonic64</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.getrawmonotonic64" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.timekeeping_clocktai">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">timekeeping_clocktai</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.timekeeping_clocktai" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.timekeeping_clocktai64">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">timekeeping_clocktai64</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.timekeeping_clocktai64" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.get_monotonic_boottime">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_monotonic_boottime</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.get_monotonic_boottime" title="連結到這個定義">¶</a><br /></dt>
<dt class="sig sig-object c" id="c.get_monotonic_boottime64">
<span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_monotonic_boottime64</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.get_monotonic_boottime64" title="連結到這個定義">¶</a><br /></dt>
<dd><p>These are replaced by <a class="reference internal" href="#c.ktime_get_raw" title="ktime_get_raw"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_raw()</span></code></a>/<a class="reference internal" href="#c.ktime_get_raw_ts64" title="ktime_get_raw_ts64"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_raw_ts64()</span></code></a>,
<a class="reference internal" href="#c.ktime_get_clocktai" title="ktime_get_clocktai"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_clocktai()</span></code></a>/<a class="reference internal" href="#c.ktime_get_clocktai_ts64" title="ktime_get_clocktai_ts64"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_clocktai_ts64()</span></code></a> as well
as <a class="reference internal" href="#c.ktime_get_boottime" title="ktime_get_boottime"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_boottime()</span></code></a>/<a class="reference internal" href="#c.ktime_get_boottime_ts64" title="ktime_get_boottime_ts64"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_boottime_ts64()</span></code></a>.
However, if the particular choice of clock source is not
important for the user, consider converting to
<a class="reference internal" href="#c.ktime_get" title="ktime_get"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get()</span></code></a>/<a class="reference internal" href="#c.ktime_get_ts64" title="ktime_get_ts64"><code class="xref c c-func docutils literal notranslate"><span class="pre">ktime_get_ts64()</span></code></a> instead for consistency.</p>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;The kernel development community.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/core-api/timekeeping.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
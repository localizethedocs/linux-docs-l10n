<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Attack Vector Controls &#8212; The Linux Kernel  文档</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=adfc0c0d" />
    <script src="../../_static/documentation_options.js?v=7d86a446"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=beaddf03"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/linux-docs-l10n/admin-guide/hw-vuln/attack_vector_controls.html" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="Spectre Side Channels" href="spectre.html" />
    <link rel="prev" title="Hardware vulnerabilities" href="index.html" />

   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

<script type="text/javascript" src="../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../ltd-flyout.js"></script>

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.svg" alt="Logo of The Linux Kernel"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.18.0-rc2</p>







<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="提交" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>


<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/submitting-patches.html">Submitting patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/code-of-conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">Maintainer handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">All development-process docs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">Driver APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../subsystem-apis.html">Subsystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">Writing documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">Development tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/testing-overview.html">Testing guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../livepatch/index.html">Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rust/index.html">Rust</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Administration</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#general-guides-to-kernel-administration">General guides to kernel administration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../README.html">Linux kernel release 6.x &lt;http://kernel.org/&gt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="../devices.html">Linux allocated devices (4.x+ version)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features.html">Feature status on all architectures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sysfs-rules.html">Rules on how to access information in sysfs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sysctl/index.html">Documentation for /proc/sys</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cputopology.html">How CPU topology info is exported via sysfs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abi.html">Linux ABI description</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Hardware vulnerabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../LSM/index.html">Linux Security Module Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../perf-security.html">Perf events and tool security</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#booting-the-kernel">Booting the kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#tracking-down-and-identifying-problems">Tracking down and identifying problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#core-kernel-subsystems">Core-kernel subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#block-layer-and-filesystem-administration">Block-layer and filesystem administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#device-specific-guides">Device-specific guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#workload-analysis">Workload analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#everything-else">Everything else</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../kbuild/index.html">Build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Userspace tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../userspace-api/index.html">Userspace API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicetree/index.html">Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arch/index.html">CPU architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html">Unsorted documentation</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/admin-guide/hw-vuln/attack_vector_controls.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="attack-vector-controls">
<h1>Attack Vector Controls<a class="headerlink" href="#attack-vector-controls" title="Link to this heading">¶</a></h1>
<p>Attack vector controls provide a simple method to configure only the mitigations
for CPU vulnerabilities which are relevant given the intended use of a system.
Administrators are encouraged to consider which attack vectors are relevant and
disable all others in order to recoup system performance.</p>
<p>When new relevant CPU vulnerabilities are found, they will be added to these
attack vector controls so administrators will likely not need to reconfigure
their command line parameters as mitigations will continue to be correctly
applied based on the chosen attack vector controls.</p>
<section id="attack-vectors">
<h2>Attack Vectors<a class="headerlink" href="#attack-vectors" title="Link to this heading">¶</a></h2>
<p>There are 5 sets of attack-vector mitigations currently supported by the kernel:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#user-kernel"><span class="std std-ref">User-to-Kernel</span></a></p></li>
<li><p><a class="reference internal" href="#user-user"><span class="std std-ref">User-to-User</span></a></p></li>
<li><p><a class="reference internal" href="#guest-host"><span class="std std-ref">Guest-to-Host</span></a></p></li>
<li><p><a class="reference internal" href="#guest-guest"><span class="std std-ref">Guest-to-Guest</span></a></p></li>
<li><p><a class="reference internal" href="#smt"><span class="std std-ref">Cross-Thread</span></a></p></li>
</ol>
<p>To control the enabled attack vectors, see <a class="reference internal" href="#cmdline"><span class="std std-ref">Command Line Controls</span></a>.</p>
<section id="user-to-kernel">
<span id="user-kernel"></span><h3>User-to-Kernel<a class="headerlink" href="#user-to-kernel" title="Link to this heading">¶</a></h3>
<p>The user-to-kernel attack vector involves a malicious userspace program
attempting to leak kernel data into userspace by exploiting a CPU vulnerability.
The kernel data involved might be limited to certain kernel memory, or include
all memory in the system, depending on the vulnerability exploited.</p>
<p>If no untrusted userspace applications are being run, such as with single-user
systems, consider disabling user-to-kernel mitigations.</p>
<p>Note that the CPU vulnerabilities mitigated by Linux have generally not been
shown to be exploitable from browser-based sandboxes.  User-to-kernel
mitigations are therefore mostly relevant if unknown userspace applications may
be run by untrusted users.</p>
<p><em>user-to-kernel mitigations are enabled by default</em></p>
</section>
<section id="user-to-user">
<span id="user-user"></span><h3>User-to-User<a class="headerlink" href="#user-to-user" title="Link to this heading">¶</a></h3>
<p>The user-to-user attack vector involves a malicious userspace program attempting
to influence the behavior of another unsuspecting userspace program in order to
exfiltrate data.  The vulnerability of a userspace program is based on the
program itself and the interfaces it provides.</p>
<p>If no untrusted userspace applications are being run, consider disabling
user-to-user mitigations.</p>
<p>Note that because the Linux kernel contains a mapping of all physical memory,
preventing a malicious userspace program from leaking data from another
userspace program requires mitigating user-to-kernel attacks as well for
complete protection.</p>
<p><em>user-to-user mitigations are enabled by default</em></p>
</section>
<section id="guest-to-host">
<span id="guest-host"></span><h3>Guest-to-Host<a class="headerlink" href="#guest-to-host" title="Link to this heading">¶</a></h3>
<p>The guest-to-host attack vector involves a malicious VM attempting to leak
hypervisor data into the VM.  The data involved may be limited, or may
potentially include all memory in the system, depending on the vulnerability
exploited.</p>
<p>If no untrusted VMs are being run, consider disabling guest-to-host mitigations.</p>
<p><em>guest-to-host mitigations are enabled by default if KVM support is present</em></p>
</section>
<section id="guest-to-guest">
<span id="guest-guest"></span><h3>Guest-to-Guest<a class="headerlink" href="#guest-to-guest" title="Link to this heading">¶</a></h3>
<p>The guest-to-guest attack vector involves a malicious VM attempting to influence
the behavior of another unsuspecting VM in order to exfiltrate data.  The
vulnerability of a VM is based on the code inside the VM itself and the
interfaces it provides.</p>
<p>If no untrusted VMs, or only a single VM is being run, consider disabling
guest-to-guest mitigations.</p>
<p>Similar to the user-to-user attack vector, preventing a malicious VM from
leaking data from another VM requires mitigating guest-to-host attacks as well
due to the Linux kernel phys map.</p>
<p><em>guest-to-guest mitigations are enabled by default if KVM support is present</em></p>
</section>
<section id="cross-thread">
<span id="smt"></span><h3>Cross-Thread<a class="headerlink" href="#cross-thread" title="Link to this heading">¶</a></h3>
<p>The cross-thread attack vector involves a malicious userspace program or
malicious VM either observing or attempting to influence the behavior of code
running on the SMT sibling thread in order to exfiltrate data.</p>
<p>Many cross-thread attacks can only be mitigated if SMT is disabled, which will
result in reduced CPU core count and reduced performance.</p>
<p>If cross-thread mitigations are fully enabled ('auto,nosmt'), all mitigations
for cross-thread attacks will be enabled.  SMT may be disabled depending on
which vulnerabilities are present in the CPU.</p>
<p>If cross-thread mitigations are partially enabled ('auto'), mitigations for
cross-thread attacks will be enabled but SMT will not be disabled.</p>
<p>If cross-thread mitigations are disabled, no mitigations for cross-thread
attacks will be enabled.</p>
<p>Cross-thread mitigation may not be required if core-scheduling or similar
techniques are used to prevent untrusted workloads from running on SMT siblings.</p>
<p><em>cross-thread mitigations default to partially enabled</em></p>
</section>
</section>
<section id="command-line-controls">
<span id="cmdline"></span><h2>Command Line Controls<a class="headerlink" href="#command-line-controls" title="Link to this heading">¶</a></h2>
<p>Attack vectors are controlled through the mitigations= command line option.  The
value provided begins with a global option and then may optionally include one
or more options to disable various attack vectors.</p>
<dl>
<dt>Format:</dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">mitigations=[global]</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">mitigations=[global],[attack</span> <span class="pre">vectors]</span></code></div>
</div>
</dd>
</dl>
<p>Global options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>'off'</p></td>
<td><p>All attack vectors disabled.</p></td>
</tr>
<tr class="row-odd"><td><p>'auto'</p></td>
<td><p>All attack vectors enabled, partial cross-thread mitigations.</p></td>
</tr>
<tr class="row-even"><td><p>'auto,nosmt'</p></td>
<td><p>All attack vectors enabled, full cross-thread mitigations.</p></td>
</tr>
</tbody>
</table>
<p>Attack vector options:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>'no_user_kernel'</p></td>
<td><p>Disables user-to-kernel mitigations.</p></td>
</tr>
<tr class="row-odd"><td><p>'no_user_user'</p></td>
<td><p>Disables user-to-user mitigations.</p></td>
</tr>
<tr class="row-even"><td><p>'no_guest_host'</p></td>
<td><p>Disables guest-to-host mitigations.</p></td>
</tr>
<tr class="row-odd"><td><p>'no_guest_guest'</p></td>
<td><p>Disables guest-to-guest mitigations</p></td>
</tr>
<tr class="row-even"><td><p>'no_cross_thread'</p></td>
<td><p>Disables all cross-thread mitigations.</p></td>
</tr>
</tbody>
</table>
<p>Multiple attack vector options may be specified in a comma-separated list.  If
the global option is not specified, it defaults to 'auto'.  The global option
'off' is equivalent to disabling all attack vectors.</p>
<dl>
<dt>Examples:</dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">mitigations=auto,no_user_kernel</span></code></div>
</div>
<p>Enable all attack vectors except user-to-kernel.  Partial cross-thread
mitigations.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">mitigations=auto,nosmt,no_guest_host,no_guest_guest</span></code></div>
</div>
<p>Enable all attack vectors and cross-thread mitigations except for
guest-to-host and guest-to-guest mitigations.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">mitigations=,no_cross_thread</span></code></div>
</div>
<p>Enable all attack vectors but not cross-thread mitigations.</p>
</dd>
</dl>
</section>
<section id="interactions-with-command-line-options">
<h2>Interactions with command-line options<a class="headerlink" href="#interactions-with-command-line-options" title="Link to this heading">¶</a></h2>
<p>Vulnerability-specific controls (e.g. &quot;retbleed=off&quot;) take precedence over all
attack vector controls.  Mitigations for individual vulnerabilities may be
turned on or off via their command-line options regardless of the attack vector
controls.</p>
</section>
<section id="summary-of-attack-vector-mitigations">
<h2>Summary of attack-vector mitigations<a class="headerlink" href="#summary-of-attack-vector-mitigations" title="Link to this heading">¶</a></h2>
<p>When a vulnerability is mitigated due to an attack-vector control, the default
mitigation option for that particular vulnerability is used.  To use a different
mitigation, please use the vulnerability-specific command line option.</p>
<p>The table below summarizes which vulnerabilities are mitigated when different
attack vectors are enabled and assuming the CPU is vulnerable.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Vulnerability</p></th>
<th class="head"><p>User-to-Kernel</p></th>
<th class="head"><p>User-to-User</p></th>
<th class="head"><p>Guest-to-Host</p></th>
<th class="head"><p>Guest-to-Guest</p></th>
<th class="head"><p>Cross-Thread</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BHI</p></td>
<td><p>X</p></td>
<td></td>
<td><p>X</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ITS</p></td>
<td><p>X</p></td>
<td></td>
<td><p>X</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>GDS</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>(Note 1)</p></td>
</tr>
<tr class="row-odd"><td><p>L1TF</p></td>
<td><p>X</p></td>
<td></td>
<td><p>X</p></td>
<td></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>(Note 2)</p></td>
</tr>
<tr class="row-even"><td><p>MDS</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>(Note 2)</p></td>
</tr>
<tr class="row-odd"><td><p>MMIO</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>(Note 2)</p></td>
</tr>
<tr class="row-even"><td><p>Meltdown</p></td>
<td><p>X</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Retbleed</p></td>
<td><p>X</p></td>
<td></td>
<td><p>X</p></td>
<td></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>(Note 3)</p></td>
</tr>
<tr class="row-even"><td><p>RFDS</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Spectre_v1</p></td>
<td><p>X</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Spectre_v2</p></td>
<td><p>X</p></td>
<td></td>
<td><p>X</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Spectre_v2_user</p></td>
<td></td>
<td><p>X</p></td>
<td></td>
<td><p>X</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>(Note 1)</p></td>
</tr>
<tr class="row-even"><td><p>SRBDS</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>SRSO</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>SSB</p></td>
<td></td>
<td><p>X</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>TAA</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>(Note 2)</p></td>
</tr>
<tr class="row-even"><td><p>TSA</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td><p>X</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>VMSCAPE</p></td>
<td></td>
<td></td>
<td><p>X</p></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<dl>
<dt>Notes:</dt><dd><p>1 --  Can be mitigated without disabling SMT.</p>
<p>2 --  Disables SMT if cross-thread mitigations are fully enabled  and the CPU
is vulnerable</p>
<p>3 --  Disables SMT if cross-thread mitigations are fully enabled, the CPU is
vulnerable, and STIBP is not supported</p>
</dd>
</dl>
<p>When an attack-vector is disabled, all mitigations for the vulnerabilities
listed in the above table are disabled, unless mitigation is required for a
different enabled attack-vector or a mitigation is explicitly selected via a
vulnerability-specific command line option.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;The kernel development community.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/admin-guide/hw-vuln/attack_vector_controls.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>
<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Xe Configfs &#8212; The Linux Kernel unknown version 文档</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=adfc0c0d" />
    <script src="../../_static/documentation_options.js?v=c459948e"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=beaddf03"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/linux-docs-l10n/gpu/xe/xe_configfs.html" />
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="Arm Framebuffer Compression (AFBC)" href="../afbc.html" />
    <link rel="prev" title="Xe DRM client usage stats implementation" href="xe-drm-usage-stats.html" />

   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

<script type="text/javascript" src="../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../ltd-flyout.js"></script>

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.svg" alt="Logo of The Linux Kernel"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">The Linux Kernel</a></h1>



<p class="blurb">6.19.0</p>







<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="提交" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>


<p>
<h3 class="kernel-toc-contents">Contents</h3>
<input type="checkbox" class="kernel-toc-toggle" id = "kernel-toc-toggle" checked>
<label class="kernel-toc-title" for="kernel-toc-toggle"></label>

<div class="kerneltoc" id="kerneltoc">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/development-process.html">Development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/submitting-patches.html">Submitting patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/code-of-conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">Maintainer handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">All development-process docs</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">Driver APIs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../subsystem-apis.html">Subsystems</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../subsystem-apis.html#core-subsystems">Core subsystems</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../subsystem-apis.html#human-interfaces">Human interfaces</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../input/index.html">Input Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sound/index.html">Sound Subsystem Documentation</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">GPU Driver Developer's Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../leds/index.html">LEDs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../subsystem-apis.html#networking-interfaces">Networking interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../subsystem-apis.html#storage-interfaces">Storage interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../subsystem-apis.html#other-subsystems">Other subsystems</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../locking/index.html">Locking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/license-rules.html">Licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">Writing documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">Development tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/testing-overview.html">Testing guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Hacking guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fault-injection/index.html">Fault injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../livepatch/index.html">Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rust/index.html">Rust</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kbuild/index.html">Build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Userspace tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../userspace-api/index.html">Userspace API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../firmware-guide/index.html">Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicetree/index.html">Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../arch/index.html">CPU architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../staging/index.html">Unsorted documentation</a></li>
</ul>

</div>

<script type="text/javascript"> <!--
  var sbar = document.getElementsByClassName("sphinxsidebar")[0];
  let currents = document.getElementsByClassName("current")
  if (currents.length) {
    sbar.scrollTop = currents[currents.length - 1].offsetTop;
  }
  --> </script>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/gpu/xe/xe_configfs.rst.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="xe-configfs">
<span id="id1"></span><h1>Xe Configfs<a class="headerlink" href="#xe-configfs" title="Link to this heading">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>Configfs is a filesystem-based manager of kernel objects. Xe KMD registers a
configfs subsystem called <code class="docutils literal notranslate"><span class="pre">xe</span></code> that creates a directory in the mounted
configfs directory. The user can create devices under this directory and
configure them as necessary. See <a class="reference internal" href="../../filesystems/configfs.html"><span class="doc">Configfs - Userspace-driven Kernel Object Configuration</span></a> for
more information about how configfs works.</p>
</section>
<section id="create-devices">
<h2>Create devices<a class="headerlink" href="#create-devices" title="Link to this heading">¶</a></h2>
<p>To create a device, the <code class="docutils literal notranslate"><span class="pre">xe</span></code> module should already be loaded, but some
attributes can only be set before binding the device. It can be accomplished
by blocking the driver autoprobe:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo 0 &gt; /sys/bus/pci/drivers_autoprobe
# modprobe xe
</pre></div>
</div>
<p>In order to create a device, the user has to create a directory inside <code class="docutils literal notranslate"><span class="pre">xe</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># mkdir /sys/kernel/config/xe/0000:03:00.0/
</pre></div>
</div>
<p>Every device created is populated by the driver with entries that can be
used to configure it:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/sys/kernel/config/xe/
├── 0000:00:02.0
│   └── ...
├── 0000:00:02.1
│   └── ...
:
└── 0000:03:00.0
    ├── survivability_mode
    ├── gt_types_allowed
    ├── engines_allowed
    └── enable_psmi
</pre></div>
</div>
<p>After configuring the attributes as per next section, the device can be
probed with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo 0000:03:00.0 &gt; /sys/bus/pci/drivers/xe/bind
# # or
# echo 0000:03:00.0 &gt; /sys/bus/pci/drivers_probe
</pre></div>
</div>
</section>
<section id="configure-attributes">
<h2>Configure Attributes<a class="headerlink" href="#configure-attributes" title="Link to this heading">¶</a></h2>
<section id="survivability-mode">
<h3>Survivability mode:<a class="headerlink" href="#survivability-mode" title="Link to this heading">¶</a></h3>
<p>Enable survivability mode on supported cards. This setting only takes
effect when probing the device. Example to enable it:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo 1 &gt; /sys/kernel/config/xe/0000:03:00.0/survivability_mode
</pre></div>
</div>
<p>This attribute can only be set before binding to the device.</p>
</section>
<section id="allowed-gt-types">
<h3>Allowed GT types:<a class="headerlink" href="#allowed-gt-types" title="Link to this heading">¶</a></h3>
<p>Allow only specific types of GTs to be detected and initialized by the
driver.  Any combination of GT types can be enabled/disabled, although
some settings will cause the device to fail to probe.</p>
<p>Writes support both comma- and newline-separated input format. Reads
will always return one GT type per line. &quot;primary&quot; and &quot;media&quot; are the
GT type names supported by this interface.</p>
<p>This attribute can only be set before binding to the device.</p>
<p>Examples:</p>
<p>Allow both primary and media GTs to be initialized and used.  This matches
the driver's default behavior:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo &#39;primary,media&#39; &gt; /sys/kernel/config/xe/0000:03:00.0/gt_types_allowed
</pre></div>
</div>
<p>Allow only the primary GT of each tile to be initialized and used,
effectively disabling the media GT if it exists on the platform:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo &#39;primary&#39; &gt; /sys/kernel/config/xe/0000:03:00.0/gt_types_allowed
</pre></div>
</div>
<p>Allow only the media GT of each tile to be initialized and used,
effectively disabling the primary GT.  <strong>This configuration will cause
device probe failure on all current platforms, but may be allowed on
igpu platforms in the future</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo &#39;media&#39; &gt; /sys/kernel/config/xe/0000:03:00.0/gt_types_allowed
</pre></div>
</div>
<p>Disable all GTs.  Only other GPU IP (such as display) is potentially usable.
<strong>This configuration will cause device probe failure on all current
platforms, but may be allowed on igpu platforms in the future</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo &#39;&#39; &gt; /sys/kernel/config/xe/0000:03:00.0/gt_types_allowed
</pre></div>
</div>
</section>
<section id="allowed-engines">
<h3>Allowed engines:<a class="headerlink" href="#allowed-engines" title="Link to this heading">¶</a></h3>
<p>Allow only a set of engine(s) to be available, disabling the other engines
even if they are available in hardware. This is applied after HW fuses are
considered on each tile. Examples:</p>
<p>Allow only one render and one copy engines, nothing else:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo &#39;rcs0,bcs0&#39; &gt; /sys/kernel/config/xe/0000:03:00.0/engines_allowed
</pre></div>
</div>
<p>Allow only compute engines and first copy engine:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo &#39;ccs*,bcs0&#39; &gt; /sys/kernel/config/xe/0000:03:00.0/engines_allowed
</pre></div>
</div>
<p>Note that the engine names are the per-GT hardware names. On multi-tile
platforms, writing <code class="docutils literal notranslate"><span class="pre">rcs0,bcs0</span></code> to this file would allow the first render
and copy engines on each tile.</p>
<p>The requested configuration may not be supported by the platform and driver
may fail to probe. For example: if at least one copy engine is expected to be
available for migrations, but it's disabled. This is intended for debugging
purposes only.</p>
<p>This attribute can only be set before binding to the device.</p>
</section>
<section id="psmi">
<h3>PSMI<a class="headerlink" href="#psmi" title="Link to this heading">¶</a></h3>
<p>Enable extra debugging capabilities to trace engine execution. Only useful
during early platform enabling and requires additional hardware connected.
Once it's enabled, additionals WAs are added and runtime configuration is
done via debugfs. Example to enable it:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo 1 &gt; /sys/kernel/config/xe/0000:03:00.0/enable_psmi
</pre></div>
</div>
<p>This attribute can only be set before binding to the device.</p>
</section>
<section id="context-restore-bb">
<h3>Context restore BB<a class="headerlink" href="#context-restore-bb" title="Link to this heading">¶</a></h3>
<p>Allow to execute a batch buffer during any context switches. When the
GPU is restoring the context, it executes additional commands. It's useful
for testing additional workarounds and validating certain HW behaviors: it's
not intended for normal execution and will taint the kernel with TAINT_TEST
when used.</p>
<p>The syntax allows to pass straight instructions to be executed by the engine
in a batch buffer or set specific registers.</p>
<ol class="arabic">
<li><p>Generic instruction:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;engine-class&gt; cmd &lt;instr&gt; [[dword0] [dword1] [...]]
</pre></div>
</div>
</li>
<li><p>Simple register setting:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;engine-class&gt; reg &lt;address&gt; &lt;value&gt;
</pre></div>
</div>
</li>
</ol>
<p>Commands are saved per engine class: all instances of that class will execute
those commands during context switch. The instruction, dword arguments,
addresses and values are in hex format like in the examples below.</p>
<ol class="arabic">
<li><p>Execute a LRI command to write 0xDEADBEEF to register 0x4f10 after the
normal context restore:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo &#39;rcs cmd 11000001 4F100 DEADBEEF&#39; \
        &gt; /sys/kernel/config/xe/0000:03:00.0/ctx_restore_post_bb
</pre></div>
</div>
</li>
<li><p>Execute a LRI command to write 0xDEADBEEF to register 0x4f10 at the
beginning of the context restore:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo &#39;rcs cmd 11000001 4F100 DEADBEEF&#39; \
        &gt; /sys/kernel/config/xe/0000:03:00.0/ctx_restore_mid_bb
</pre></div>
</div>
</li>
<li><p>Load certain values in a couple of registers (it can be used as a simpler
alternative to the <cite>cmd</cite>) action:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># cat &gt; /sys/kernel/config/xe/0000:03:00.0/ctx_restore_post_bb &lt;&lt;EOF
rcs reg 4F100 DEADBEEF
rcs reg 4F104 FFFFFFFF
EOF
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>When using multiple lines, make sure to use a command that is
implemented with a single write syscall, like HEREDOC.</p>
</div>
</li>
</ol>
<p>Currently this is implemented only for post and mid context restore and
these attributes can only be set before binding to the device.</p>
</section>
<section id="max-sr-iov-virtual-functions">
<h3>Max SR-IOV Virtual Functions<a class="headerlink" href="#max-sr-iov-virtual-functions" title="Link to this heading">¶</a></h3>
<p>This config allows to limit number of the Virtual Functions (VFs) that can
be managed by the Physical Function (PF) driver, where value 0 disables the
PF mode (no VFs).</p>
<p>The default max_vfs config value is taken from the max_vfs modparam.</p>
<p>How to enable PF with support with unlimited (up to HW limit) number of VFs:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo unlimited &gt; /sys/kernel/config/xe/0000:00:02.0/sriov/max_vfs
# echo 0000:00:02.0 &gt; /sys/bus/pci/drivers/xe/bind
</pre></div>
</div>
<p>How to enable PF with support up to 3 VFs:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo 3 &gt; /sys/kernel/config/xe/0000:00:02.0/sriov/max_vfs
# echo 0000:00:02.0 &gt; /sys/bus/pci/drivers/xe/bind
</pre></div>
</div>
<p>How to disable PF mode and always run as native:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># echo 0 &gt; /sys/kernel/config/xe/0000:00:02.0/sriov/max_vfs
# echo 0000:00:02.0 &gt; /sys/bus/pci/drivers/xe/bind
</pre></div>
</div>
<p>This setting only takes effect when probing the device.</p>
</section>
</section>
<section id="remove-devices">
<h2>Remove devices<a class="headerlink" href="#remove-devices" title="Link to this heading">¶</a></h2>
<p>The created device directories can be removed using <code class="docutils literal notranslate"><span class="pre">rmdir</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># rmdir /sys/kernel/config/xe/0000:03:00.0/
</pre></div>
</div>
</section>
<section id="internal-api">
<h2>Internal API<a class="headerlink" href="#internal-api" title="Link to this heading">¶</a></h2>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_configfs_check_device">
<span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_configfs_check_device</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_configfs_check_device" title="Link to this definition">¶</a><br /></dt>
<dd><p>Test if device was configured by configfs</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>the <code class="xref c c-type docutils literal notranslate"><span class="pre">pci_dev</span></code> device to test</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Try to find the configfs group that belongs to the specified pci device
and print a diagnostic message if different than the default value.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_configfs_get_survivability_mode">
<span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_configfs_get_survivability_mode</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_configfs_get_survivability_mode" title="Link to this definition">¶</a><br /></dt>
<dd><p>get configfs survivability mode attribute</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>pci device</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>survivability_mode attribute in configfs</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_configfs_primary_gt_allowed">
<span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_configfs_primary_gt_allowed</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_configfs_primary_gt_allowed" title="Link to this definition">¶</a><br /></dt>
<dd><p>determine whether primary GTs are supported</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>pci device</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>True if primary GTs are enabled, false if they have been disabled via
configfs.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_configfs_media_gt_allowed">
<span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_configfs_media_gt_allowed</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_configfs_media_gt_allowed" title="Link to this definition">¶</a><br /></dt>
<dd><p>determine whether media GTs are supported</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>pci device</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>True if the media GTs are enabled, false if they have been disabled
via configfs.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_configfs_get_engines_allowed">
<span class="n"><span class="pre">u64</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_configfs_get_engines_allowed</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_configfs_get_engines_allowed" title="Link to this definition">¶</a><br /></dt>
<dd><p>get engine allowed mask from configfs</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>pci device</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>engine mask with allowed engines set in configfs</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_configfs_get_psmi_enabled">
<span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_configfs_get_psmi_enabled</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_configfs_get_psmi_enabled" title="Link to this definition">¶</a><br /></dt>
<dd><p>get configfs enable_psmi setting</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>pci device</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>enable_psmi setting in configfs</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_configfs_get_ctx_restore_mid_bb">
<span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_configfs_get_ctx_restore_mid_bb</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pdev</span></span>, <span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">xe_engine_class</span></span><span class="w"> </span><span class="n"><span class="pre">class</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_configfs_get_ctx_restore_mid_bb" title="Link to this definition">¶</a><br /></dt>
<dd><p>get configfs ctx_restore_mid_bb setting</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>pci device</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">xe_engine_class</span> <span class="pre">class</span></code></dt><dd><p>hw engine class</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">u32</span> <span class="pre">**cs</span></code></dt><dd><p>pointer to the bb to use - only valid during probe</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>Number of dwords used in the mid_ctx_restore setting in configfs</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_configfs_get_ctx_restore_post_bb">
<span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_configfs_get_ctx_restore_post_bb</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pdev</span></span>, <span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="n"><span class="pre">xe_engine_class</span></span><span class="w"> </span><span class="n"><span class="pre">class</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">u32</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_configfs_get_ctx_restore_post_bb" title="Link to this definition">¶</a><br /></dt>
<dd><p>get configfs ctx_restore_post_bb setting</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>pci device</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">xe_engine_class</span> <span class="pre">class</span></code></dt><dd><p>hw engine class</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">u32</span> <span class="pre">**cs</span></code></dt><dd><p>pointer to the bb to use - only valid during probe</p>
</dd>
</dl>
<p><strong>Return</strong></p>
<p>Number of dwords used in the post_ctx_restore setting in configfs</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.xe_configfs_get_max_vfs">
<span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">xe_configfs_get_max_vfs</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">pci_dev</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pdev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.xe_configfs_get_max_vfs" title="Link to this definition">¶</a><br /></dt>
<dd><p>Get number of VFs that could be managed</p>
</dd></dl>

<div class="kernelindent docutils container">
<p><strong>Parameters</strong></p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*pdev</span></code></dt><dd><p>the <code class="xref c c-type docutils literal notranslate"><span class="pre">pci_dev</span></code> device</p>
</dd>
</dl>
<p><strong>Description</strong></p>
<p>Find the configfs group that belongs to the PCI device and return maximum
number of Virtual Functions (VFs) that could be managed by this device.
If configfs group is not present, use value of max_vfs module parameter.</p>
<p><strong>Return</strong></p>
<p>maximum number of VFs that could be managed.</p>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;The kernel development community.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/gpu/xe/xe_configfs.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>